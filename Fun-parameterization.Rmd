# Parameters for functions {#params-intro}

```{r include=FALSE}
library(mosaic)
library(mosaicCalc)
library(math141Z)
library(lubridate)
```

The naked modeling functions provide the modeler with a collection of shapes. They are not yet fully suited to represent real-world phenomena. To illustrate, consider Figure \@ref(fig:covid-exp) which shows the number of officially confirmed cases in March 2020. 

The outbreak was widely described as "exponential," so alongside the data Figure \@ref(fig:covid-exp) shows the function $e^x$.

```{r covid-exp, echo=FALSE, fig.cap="Cumulative confirmed COVID-19 cases during the month of March, 2020. The red curve is $e^x$"}
March <- Covid_US %>% filter(month(date)==3) %>%
  mutate(day = mday(date))
gf_point(confirmed ~ day, 
         data = March) %>%
  gf_labs(y = "Cumulative confirmed cases", x = "Day in March, 2020") %>%
  gf_lims(y=c(0,200000)) %>%
  slice_plot(exp(x) ~ x, domain(x=c(0,15)), color="red", label_text = "exp(x)")
```

There's an obvious mismatch between the data and the function $e^x$. Does this mean the COVID pattern is not exponential?

A hint comes from the formula $e^x$. What is $x$? Plotted as it is in the graph, $x$ is the calender day in March. But why shouldn't $x$ be the given in hours or minutes or weeks? 

If we want the input to $\exp()$ to be in hours, we can multiply $x$ by 24. If the input is to be in weeks, the multiplier should be $\frac{1}{7} = 0.1429$. In both cases, the function will be $e^{kx}$, where $k$ would be 24 for hours or 0.1429 for weeks. Exploring a bit, we found that $0.3 \leq k < 0.5$ will produce functions graphs that match the data much better than naked $e^x$. 

```{r covid-exp2, echo=FALSE, fig.cap="COVID-19 data compared to the exponential functions $e^{kt}$. A variety of possible numerical values for $k$ is shown.", warning=FALSE}
gf_point(confirmed ~ day, data = March) %>%
  gf_labs(y = "Cumulative confirmed cases", x = "Day in March, 2020") %>%
  gf_lims(y=c(0,200000)) %>%
  slice_plot(exp(x/2) ~ x, domain(x=c(0,30)), color="green", label_text = "exp(0.5*x)", label_x=.75) %>%
  slice_plot(exp(0.4*x) ~ x, domain(x=c(0,30)), color="blue", label_text = "exp(0.4*x)", label_x=0.9) %>%
  slice_plot(exp(0.45*x) ~ x, domain(x=c(0,30)), color="orange", label_text = "exp(0.45*x)", label_x=0.9) %>%
    slice_plot(exp(0.30*x) ~ x, domain(x=c(0,35)), color="tomato", label_text = "exp(0.30*x)", label_x=0.95) %>%
  slice_plot(exp(0.20*x) ~ x, domain(x=c(0,35)), color="black", label_text = "exp(0.20*x)", label_x=0.95)
```

The multiplier $k$ in $e^{kx}$ is called a ***parameter*** of the function: a number that we can use to set the ***scale*** of the input. To use the exponential function to model COVID, we've had to stretch out the red curve in Figure \@ref(fig:covid-exp2) by clothing naked $x$ as $k x$. Perhaps it's a matter of personal choice which size of $k$ will be best suited to model the data.

My personal choice is $k=0.30$. My reasoning? The orange curve parallels the COVID data. The flaw with  $k=0.30$ is that the curve lags several the data by several days. But we can fix this by pulling the $k=0.30$ curve to the left. Mathematically this can be accomplished by subtracting a few days from $x$ before multiplying by $k$, that is, using the function $$f(x) \equiv e^{k(x-s)}$$ where $s$ stands for the shift.

```{r echo=FALSE}
mod1 <- fitModel(confirmed ~ exp(0.3*(day-s)),
                 data = March,
         start = list(s=-32))
f1 <- makeFun(mod1)
mod2 <- fitModel(confirmed ~ exp(k*(day-s)),
         data = March,
         start = list(k=0.3, s=-32) )
f2 <- makeFun(mod2)
```

Figure \@ref(fig:covid-exp3) shows the orange curve after pulling it 10 days to the left. It's now a pretty good match to the data. 


```{r covid-exp3, echo=FALSE, fig.cap="COVID-19 data compared to the exponential functions $e^{k(t-s)}$.", warning=FALSE}
gf_point(confirmed ~ day, data = March) %>%
  gf_labs(y = "Cumulative confirmed cases", x = "Day in March, 2020") %>%
  gf_lims(y=c(0,200000)) %>%
  slice_plot(f2(x) ~ x, domain(x=c(0,31)), color="green", label_text = "exp(0.19*(x+32))", label_x=.6) %>%
  slice_plot(f1(x) ~ x, domain(x=c(0,30)), color="orange", label_text = "exp(0.30*(x+10)", label_x=0.9) 
```

Note that once we've aligned the orange curve horizontally, it seems to curve too much. The green curve does much better. It has a much gentler curve, $k=0.19$ and is pulled about a little more than a month to the left.

By parameterizing the exponential function as $e^{k(x-s)}$ and finding suitable values for $k$ and $s$, we get a good match to the March data. But models can sometimes tell us more. For the green curve in Figure \@ref(fig:covid-exp3) the value of $s$ is -32 days. 32 days before March 1 is in late January. And even though we didn't have any January or February data to base the green curve on, late January 2020 is regarded as the very beginning of the outbreak.

## Scaling the input with parameters

Linear function is already there.

Use square for power law example. Then add, "We'll need some additional tools before we can make full use of the power law functions."



::: {.underconstruction}
JUST NOTES JUST NOTES
:::


The basic modeling functions such as $e^{kx}$,  $\sin(\frac{2 \pi}{P} x)$, $\text{hump}(x, \text{center}, \text{spread})$, $\text{sigmoid}(x, \text{center}, \text{spread})$ did not come in to the world fully clothed with parameters. The clothes are needed to deal with a modeling necessity: inputs to functions used for modeling are quantities with dimension and units.

Underneath the clothing of basic modeling function, you'll find what we will frivolously call the ***naked modeling functions***. These are without parameters: $e^x$, $\sin(x)$, $\text{hump}(x)$, $\text{sigmoid}(x)$. For each of these functions, $x$ must be a ***pure number***, that is, a quantity without physical dimensions.

DEVELOP THIS: $e^x$ and $\sin(x)$, when used for modeling are composed with a proportionality function. $\text{hump}()$ and $\text{sigmoid}()$ are composed with a straight-line function.

The proportionality and straight-line functions handle the conversion from dimensionful quantities with units into the pure numbers.

HOW THE HUMP AND SIGMOID GOT THEIR PARAMETERS: WE'RE ABSTRACTING FROM A COMPLICATED FORMULA, so it's easier to call them out by name.
:::


