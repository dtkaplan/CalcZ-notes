<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 27 Iteration and accumulation | CalcZ Student Notes</title>
<meta name="author" content="Daniel Kaplan">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.8/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.18/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script>
</head>
<body>
<span class="math inline">
    \(\newcommand{\line}{\text{line}}
    \newcommand{\hump}{\text{hump}}
    \newcommand{\sigmoid}{\text{sigmoid}}
    \newcommand{\recip}{\text{recip}}
    \newcommand{\diff}[1]{{\cal D}_#1}
    \newcommand{\pnorm}{\text{pnorm}}
    \newcommand{\dnorm}{\text{dnorm}}\)
    </span>

    <!-- see https://www.homepages.ucl.ac.uk/~ucahmto/elearning/2019/09/14/bookdown.html-->
    <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/CalcZ-style.css">
<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">CalcZ Student Notes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to calculus</a></li>
<li class="book-part">Block 1: Functions and quantity</li>
<li><a class="" href="outline-of-block-1.html">Outline of Block 1</a></li>
<li><a class="" href="change.html"><span class="header-section-number">1</span> Change</a></li>
<li><a class="" href="pattern-book.html"><span class="header-section-number">2</span> Modeling functions</a></li>
<li><a class="" href="structure-of-a-function.html"><span class="header-section-number">3</span> Structure of a function</a></li>
<li><a class="" href="fun-describing.html"><span class="header-section-number">4</span> Describing functions</a></li>
<li><a class="" href="fun-notation.html"><span class="header-section-number">5</span> Notation for functions</a></li>
<li><a class="" href="graphs-and-graphics.html"><span class="header-section-number">6</span> Graphics &amp; function graphs</a></li>
<li><a class="" href="params-intro.html"><span class="header-section-number">7</span> Parameters for functions</a></li>
<li><a class="" href="fun-slopes.html"><span class="header-section-number">8</span> Slope function</a></li>
<li><a class="" href="function-inverses-and-solving.html"><span class="header-section-number">9</span> Function inverses and “solving”</a></li>
<li><a class="" href="fun-assembling.html"><span class="header-section-number">10</span> Assembling functions</a></li>
<li><a class="" href="fun-multiple-inputs.html"><span class="header-section-number">11</span> Functions with multiple inputs</a></li>
<li><a class="" href="fun-piecewise.html"><span class="header-section-number">12</span> Piecewise functions</a></li>
<li><a class="" href="modeling-cycle.html"><span class="header-section-number">13</span> Modeling cycle</a></li>
<li><a class="" href="magnitudes.html"><span class="header-section-number">14</span> Magnitudes</a></li>
<li><a class="" href="dimensions.html"><span class="header-section-number">15</span> Dimensions</a></li>
<li class="book-part">Block 2: Differentiation</li>
<li><a class="" href="outline-of-block-2.html">Outline of Block 2</a></li>
<li><a class="" href="change-relationships.html"><span class="header-section-number">16</span> Change relationships</a></li>
<li><a class="" href="computing-derivs.html"><span class="header-section-number">17</span> Computing derivatives</a></li>
<li><a class="" href="convexity-and-curvature.html"><span class="header-section-number">18</span> Convexity and curvature</a></li>
<li><a class="" href="cont-and-smooth.html"><span class="header-section-number">19</span> Continuity and smoothness</a></li>
<li><a class="" href="evanescent-h.html"><span class="header-section-number">20</span> Evanescent h</a></li>
<li><a class="" href="prod-comp-rules.html"><span class="header-section-number">21</span> Differentiation of assembled functions</a></li>
<li><a class="" href="optim-and-shape.html"><span class="header-section-number">22</span> Optimization</a></li>
<li><a class="" href="partial-change.html"><span class="header-section-number">23</span> Partial change</a></li>
<li><a class="" href="local-approximations.html"><span class="header-section-number">24</span> Local approximations</a></li>
<li><a class="" href="approximation-near-a-reference-input.html"><span class="header-section-number">25</span> Approximation near a reference input</a></li>
<li class="book-part">Block 3: Accumulation</li>
<li><a class="" href="outline-of-block-3.html">Outline of Block 3</a></li>
<li><a class="" href="change-accumulation.html"><span class="header-section-number">26</span> Change and accumulation</a></li>
<li><a class="active" href="iteration-and-accumulation.html"><span class="header-section-number">27</span> Iteration and accumulation</a></li>
<li><a class="" href="net-change.html"><span class="header-section-number">28</span> Accumulation as net change</a></li>
<li><a class="" href="integration.html"><span class="header-section-number">29</span> Integration</a></li>
<li><a class="" href="accum-advanced-algebra.html"><span class="header-section-number">30</span> Advanced algebraic methods</a></li>
<li><a class="" href="antidiff-review.html"><span class="header-section-number">31</span> Review of anti-differentiation methods</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/dtkaplan/CalcZ-notes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="iteration-and-accumulation" class="section level1" number="27">
<h1>
<span class="header-section-number">27</span> Iteration and accumulation<a class="anchor" aria-label="anchor" href="#iteration-and-accumulation"><i class="fas fa-link"></i></a>
</h1>
<p>Let’s review the concept of an <strong><em>Euler step</em></strong>.</p>
<p><strong>Problem statement</strong>:</p>
<ol style="list-style-type: decimal">
<li>You seek to find a function, e.g. <span class="math inline">\(f(t)\)</span> which you do not yet know.</li>
<li>You already know <span class="math inline">\(\partial_t f(t)\)</span>. (In the following chapters we’ll show you some of the many instances of this unlikely-sounding situation, where you don’t know <span class="math inline">\(f(t)\)</span> but you do know <span class="math inline">\(\partial_t f(t)\)</span>.) This relationship, <span class="math inline">\(\partial_t f(t) \longrightarrow f(t)\)</span> is, of course, revealed by <strong><em>anti-differentiation</em></strong>. <span style="float: right; padding-left: 50px;"><a name="3300" href="#3300"><img src="www/icons8-signpost.png" title="Location: 3300" width="12px"></a><span style="color: red; font-size: 6pt;">3300</span></span>
</li>
</ol>
<p><strong>Setup</strong>:</p>
<ol start="3" style="list-style-type: decimal">
<li>You know or make up a value for <span class="math inline">\(f(t)\)</span> at a particular time of interest <span class="math inline">\(t=t_0\)</span>. “Making up” is a perfectly legitimate practice here to get started in creating an an anti-derivative. The reason is hard to explain until you see the whole process of anti-differentiation by the <strong><em>Euler method</em></strong>, so hang on. In the population modeling problem in Chapter <a href="change-accumulation.html#change-accumulation">26</a>, we were interested in forecasting the population into the future, so we chose <span class="math inline">\(t_0\)</span> to be the most recent year for which we have information: <span class="math inline">\(t_0 = 2020\)</span>. (In polite mathematical conversation, “making up” is pronounced “assuming.”)</li>
<li>Consider a quantity <span class="math inline">\(h\)</span> which is to be regarded as a little bit of <span class="math inline">\(t\)</span>: they have the same dimension. <span class="math inline">\(h\)</span> should be “small,” but “small” compared to what? Often, the modeling problem at hand involves a domain of interest. For instance, the population modeling problem in Chapter <a href="change-accumulation.html#change-accumulation">26</a> involved a forecast over the time interval from year 2020 to 2100. Provisionally, take small to mean 1% or 0.1% of the extent of the domain of interest. (In the population modeling problem, we chose <span class="math inline">\(h=1\)</span> year.) <span style="float: right; padding-left: 50px;"><a name="3305" href="#3305"><img src="www/icons8-signpost.png" title="Location: 3305" width="12px"></a><span style="color: red; font-size: 6pt;">3305</span></span>
</li>
</ol>
<p><strong>The Step</strong></p>
<ol style="list-style-type: decimal">
<li>Compute the value of the (still unknown) function <span class="math inline">\(f(t)\)</span> at input <span class="math inline">\(t_0 + h\)</span> as
<span class="math display">\[f(t_0+h) = f(t_0) + h \times \partial_t f(t)\]</span>
</li>
</ol>
<p>Now you know a little bit more about <span class="math inline">\(f(t)\)</span>, namely, its value at <span class="math inline">\(t_0 + h\)</span>.</p>
<p>Since the original problem was to figure out <span class="math inline">\(f(t)\)</span> over some domain of interest (starting at <span class="math inline">\(t=t_0\)</span>), we are not finished. We have taken but one step of our journey and have many more to go.</p>
<p>To continue on the journey, we take what we just found out, namely <span class="math inline">\(f(t_0 + h)\)</span>. We use this as the starting point in a new step. We don’t have to make anything up because we already know <span class="math inline">\(f(t_0 + h)\)</span>. <span style="float: right; padding-left: 50px;"><a name="3310" href="#3310"><img src="www/icons8-signpost.png" title="Location: 3310" width="12px"></a><span style="color: red; font-size: 6pt;">3310</span></span></p>
<p>The second step brings us to <span class="math inline">\(f(t_0 + 2h)\)</span></p>
<p><span class="math display">\[f(t_0+2h) = f(t_0+h) + h \times \partial_t f(t+h)\]</span>
And the third:
<span class="math display">\[f(t_0+3h) = f(t_0+2h) + h \times \partial_t f(t+2h)\]</span></p>
<p>How long to continue this step-by-step process? The original problem involved some domain of interest, and we selected <span class="math inline">\(h\)</span> as 1% or 0.1% of the extent of this domain. For <span class="math inline">\(h\)</span> as 1%, taking 100 steps will get us to the far end of the domain. For <span class="math inline">\(h\)</span> as 0.1%, we would need to take 1000 steps. <span style="float: right; padding-left: 50px;"><a name="3315" href="#3315"><img src="www/icons8-signpost.png" title="Location: 3315" width="12px"></a><span style="color: red; font-size: 6pt;">3315</span></span></p>
<details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Accum/euler-step.Rmd" href="#9W6VB"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/euler-step.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">9W6VB</span>
</span></summary><p>Using the Euler method find <span class="math inline">\(\int f(t) dt\)</span> over the interval <span class="math inline">\(t_0=0\)</span> to <span class="math inline">\(t_{end}=1\)</span>. The <span class="math inline">\(t\)</span> quantity is in steps of <span class="math inline">\(h=0.01\)</span>.</p>
<table class="table table-sm">
<thead><tr class="header">
<th><span class="math inline">\(t\)</span></th>
<th><span class="math inline">\(\partial_t f(t)\)</span></th>
<th><span class="math inline">\(\int f(t) dt\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.399</td>
<td>0.5</td>
</tr>
<tr class="even">
<td>0.01</td>
<td>0.242</td>
<td></td>
</tr>
<tr class="odd">
<td>0.02</td>
<td>0.054</td>
<td></td>
</tr>
</tbody>
</table>
0.03 | 0.399 |
</details><div id="automating-euler" class="section level2" number="27.1">
<h2>
<span class="header-section-number">27.1</span> Automating Euler<a class="anchor" aria-label="anchor" href="#automating-euler"><i class="fas fa-link"></i></a>
</h2>
<p>Although the Euler method was invented in the 18th century, it only became a practicable way of accumulating in the 1930s with the advent of analog computing and then in the 1940s when electronic computing was first becoming available. In those days, a primary mission for computers was accumulating the trajectories of artillery shells, a problem that was inaccessible to symbolic anti-differentiation because of the complexities of air resistence and the varying density of air at different altitudes, with different humidity, and so on. <span style="float: right; padding-left: 50px;"><a name="3320" href="#3320"><img src="www/icons8-signpost.png" title="Location: 3320" width="12px"></a><span style="color: red; font-size: 6pt;">3320</span></span></p>
<p>Nowadays computing is roughly one-billionth the cost that it was the World War II era, and we use computers for just about every task imaginable. But in those early days, the huge costs involved in developing early computers was justified only by the prospect of improved gunnery in war. And those problems were all about accumulation and, more specifically, Euler methods. <span style="float: right; padding-left: 50px;"><a name="3325" href="#3325"><img src="www/icons8-signpost.png" title="Location: 3325" width="12px"></a><span style="color: red; font-size: 6pt;">3325</span></span></p>
<p>What today seems an esoteric use for computers was in fact the prime motivation for their development. This section introduces various ways of programming the Euler method on a computer.</p>
<div class="takenote">
<p>The Euler method has been supplanted by other, more modern methods whose inner workings are based on a deeper knowledge of calculus than we have covered to date and programming methods that automatically check and adapt the size of <span class="math inline">\(h\)</span>. <span style="float: right; padding-left: 50px;"><a name="3330" href="#3330"><img src="www/icons8-signpost.png" title="Location: 3330" width="12px"></a><span style="color: red; font-size: 6pt;">3330</span></span></p>
<p>However sophisticated these methods may be, they are always easy to use. For example, the R/mosaic <code>antiD()</code> operator draws on one of these methods.</p>
</div>
<div id="euler-as-a-spreadsheet" class="section level3" number="27.1.1">
<h3>
<span class="header-section-number">27.1.1</span> Euler as a spreadsheet<a class="anchor" aria-label="anchor" href="#euler-as-a-spreadsheet"><i class="fas fa-link"></i></a>
</h3>
<p>Spreadsheets are popular for certain simple kinds of computer programming. The Euler method is a case in point. Figure <a href="iteration-and-accumulation.html#fig:euler-spreadsheet1">27.1</a> shows the formula layer of a Google Sheet implementing the Euler method for <span class="math inline">\(\int \dnorm(t) dt\)</span>. In the spreadsheet, <code>NORMDIST()</code> is the equivalent of <span class="math inline">\(\dnorm()\)</span>. <span style="float: right; padding-left: 50px;"><a name="3335" href="#3335"><img src="www/icons8-signpost.png" title="Location: 3335" width="12px"></a><span style="color: red; font-size: 6pt;">3335</span></span></p>
<div class="figure" style="text-align: center">
<span id="fig:euler-spreadsheet1"></span>
<img src="www/Euler-spreadsheet1.png" alt="The formula layer of a spreadsheet implementing the Euler method for $\int \dnorm(x) dx$. The whole spreadsheet is viewable [here](https://docs.google.com/spreadsheets/d/1e3SwcNLQxoYCUedALia6XxzIlh5kY_dTohFroewbNR8/edit?usp=sharing)" width="90%"><p class="caption">
Figure 27.1: The formula layer of a spreadsheet implementing the Euler method for <span class="math inline">\(\int \dnorm(x) dx\)</span>. The whole spreadsheet is viewable <a href="https://docs.google.com/spreadsheets/d/1e3SwcNLQxoYCUedALia6XxzIlh5kY_dTohFroewbNR8/edit?usp=sharing">here</a>
</p>
</div>
<p>The first argument to <code>NORMDIST()</code> is a reference to a cell in column B which stores the sequence <span class="math inline">\(t_0\)</span>, <span class="math inline">\(t_0 + h\)</span>, <span class="math inline">\(t_0 + 2h, \ldots\)</span>. (The value of <span class="math inline">\(h\)</span> is stored in cell <code>H2</code> (not shown).) Column D contains the results of the Euler calculation. It starts at time <span class="math inline">\(t_0=0\)</span> by referencing cell <code>H4</code> (not shown) which contains the starting value <span class="math inline">\(f(t_0)\)</span>. Each successive cell in that column refers to the one immediately above that, adding in the appropriate value from the <code>NORMDIST()</code> column and multiplying it by <span class="math inline">\(h\)</span> (that is, <code>H2</code>). <span style="float: right; padding-left: 50px;"><a name="3340" href="#3340"><img src="www/icons8-signpost.png" title="Location: 3340" width="12px"></a><span style="color: red; font-size: 6pt;">3340</span></span></p>
<p>Only about 10 Euler steps are shown, out of 100 altogether. Typically in viewing a spreadsheet you don’t see the formula layer. Instead, the results of the calculation in each cell are presented. (Figure <a href="iteration-and-accumulation.html#fig:euler-spreadsheet2">27.2</a>). <span style="float: right; padding-left: 50px;"><a name="3345" href="#3345"><img src="www/icons8-signpost.png" title="Location: 3345" width="12px"></a><span style="color: red; font-size: 6pt;">3345</span></span></p>
<div class="figure" style="text-align: center">
<span id="fig:euler-spreadsheet2"></span>
<img src="www/Euler-spreadsheet2.png" alt="Results from the formula layer shown in Figure \@ref(fig:euler-spreadsheet1)." width="90%"><p class="caption">
Figure 27.2: Results from the formula layer shown in Figure <a href="iteration-and-accumulation.html#fig:euler-spreadsheet1">27.1</a>.
</p>
</div>
<p>Plotting column <code>D</code> against column <code>B</code> gives a graph of <span class="math inline">\(\int \dnorm(t) dt\)</span> versus <span class="math inline">\(t\)</span>. Notice that the output of the Euler method is a function stored as a <strong><em>table</em></strong> rather than as a function formula. And even though <span class="math inline">\(\int \dnorm(t) dt\)</span> has a pretty simple form, namely, <span class="math inline">\(\pnorm(t)\)</span>, the spreadsheet makes it look like something more elaborate. <span style="float: right; padding-left: 50px;"><a name="3350" href="#3350"><img src="www/icons8-signpost.png" title="Location: 3350" width="12px"></a><span style="color: red; font-size: 6pt;">3350</span></span></p>
<p>Spreadsheets are rightly criticized for being verbose. This can make it extremely challenging for the human programmer to create a spreadsheet that does what is claimed for it, let alone to demonstrate that the result is correct. <span style="float: right; padding-left: 50px;"><a name="3355" href="#3355"><img src="www/icons8-signpost.png" title="Location: 3355" width="12px"></a><span style="color: red; font-size: 6pt;">3355</span></span></p>
<p>Worse, it’s hard to generalize a spreadsheet to handle any given function rather than the one (here, <code>NORMDIST()</code>) hard-coded into the sheet. A usual practice is to copy a spreadsheet and then customize it to use the function whose anti-derivative is sought. This introduces the potential for human error in a way that can be hard to detect down the line. <span style="float: right; padding-left: 50px;"><a name="3360" href="#3360"><img src="www/icons8-signpost.png" title="Location: 3360" width="12px"></a><span style="color: red; font-size: 6pt;">3360</span></span></p>
</div>
<div id="using-antid" class="section level3" number="27.1.2">
<h3>
<span class="header-section-number">27.1.2</span> Using <code>antiD()</code><a class="anchor" aria-label="anchor" href="#using-antid"><i class="fas fa-link"></i></a>
</h3>
<p>The R/mosaic <code>antiD()</code> operator uses symbolic differentiation if it can. Otherwise it uses numerical methods in the spirit of Euler. Here is the same anti-differentiation as in the spreadsheet but done with <code>antiD()</code>: <span style="float: right; padding-left: 50px;"><a name="3365" href="#3365"><img src="www/icons8-signpost.png" title="Location: 3365" width="12px"></a><span style="color: red; font-size: 6pt;">3365</span></span></p>
<p>It happens that <span class="math inline">\(\dnorm(t)\)</span> is one of those many functions where the anti-derivative cannot be calculated symbolically. (We already know that <span class="math inline">\(\int \dnorm(t) dt = \pnorm(t)\)</span>, but this in fact the <em>definition</em> of <span class="math inline">\(\pnorm()\)</span>, which is only known from numerical calculations like Euler.) <span style="float: right; padding-left: 50px;"><a name="3370" href="#3370"><img src="www/icons8-signpost.png" title="Location: 3370" width="12px"></a><span style="color: red; font-size: 6pt;">3370</span></span></p>
<p>An advantage of using programming systems like R/mosaic is that they provide a way to do something with the result of the calculation. You could of course plot <code>f()</code> with <code>slice_plot()</code>, but let’s show something much more fundamental … <span style="float: right; padding-left: 50px;"><a name="3375" href="#3375"><img src="www/icons8-signpost.png" title="Location: 3375" width="12px"></a><span style="color: red; font-size: 6pt;">3375</span></span></p>
<blockquote>
<p><strong>How do we know that <code>antiD()</code> is giving the result it should give?</strong></p>
</blockquote>
<p>Whenever you do a calculation, you should ask a similar question: “How do I know that [<em>my calculation</em>] is giving the result it should?” In general, it takes considerable experience to provide an answer to such a question, but in the case of <code>antiD()</code>, the approach is simple: If <code>f()</code> is really the anti-derivative of <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code>, then differentiating <code>f()</code> should give us something that’s the same as <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code>. <span style="float: right; padding-left: 50px;"><a name="3380" href="#3380"><img src="www/icons8-signpost.png" title="Location: 3380" width="12px"></a><span style="color: red; font-size: 6pt;">3380</span></span></p>
<div class="inline-figure">Here’s the actual calculation:
<img src="CalcZ-notes_files/figure-html/unnamed-chunk-148-1.png" width="90%" style="display: block; margin: auto;">
</div>
<p>With numerical methods, there will almost always be some error introduced by round-off in the calculations, so we should never expect the deviation to be zero. You can see from the plot of the deviation (Look carefully at the vertical axis!) that it is smaller than 0.0000000001, which is a tiny, tiny part of the size of the output from <span class="math inline">\(\dnorm()\)</span>. <span style="float: right; padding-left: 50px;"><a name="3385" href="#3385"><img src="www/icons8-signpost.png" title="Location: 3385" width="12px"></a><span style="color: red; font-size: 6pt;">3385</span></span></p>
<p>It might seem odd to use 3 lines of R/mosaic commands to confirm an answer that was calculated in one line. That’s a pretty good representation of how much effort a professional will put into <strong>testing</strong> the result compared to <strong>getting</strong> the result. <span style="float: right; padding-left: 50px;"><a name="3390" href="#3390"><img src="www/icons8-signpost.png" title="Location: 3390" width="12px"></a><span style="color: red; font-size: 6pt;">3390</span></span></p>
</div>
<div id="using-cumsum" class="section level3" number="27.1.3">
<h3>
<span class="header-section-number">27.1.3</span> Using <code>cumsum()</code><a class="anchor" aria-label="anchor" href="#using-cumsum"><i class="fas fa-link"></i></a>
</h3>
<p><code>antiD()</code> produces a function that can be evaluated at any input. In contrast,
the Euler method as described here produces a data table of values as, for example, seen in the spreadsheet implementation of Euler.</p>
<p>In R, a data table can be created with the <code>data.table()</code> function. Here’ we’ll illustrate how to implement Euler with this format as a topic. The raw ingredients are:</p>
<ul>
<li>
<span class="math inline">\(t_0\)</span> and <span class="math inline">\(t_\text{end}\)</span>, the start and end of the input interval over which you want to do the accumulation.</li>
<li>Your choice of <span class="math inline">\(h\)</span>. We’ll set this to 1/100 of the length of the input interval.</li>
<li>The function that you want to accumulate. We’ll represent that with a tilde expression in exactly the same manner as <code>makeFun()</code>, <code><a href="https://rdrr.io/r/stats/deriv.html">D()</a></code>, and other operators in the R/mosaic suite of software. We’ll implement the method as a series of steps that make a data table whose <code>t</code> and <code>accum</code> columns describe the accumulated function. <span style="float: right; padding-left: 50px;"><a name="3395" href="#3395"><img src="www/icons8-signpost.png" title="Location: 3395" width="12px"></a><span style="color: red; font-size: 6pt;">3395</span></span>
</li>
</ul>
<p>The <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> function is easy to understand. First, know that <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> adds together a set of numbers. For instance, here’s a data frame with the numbers 0, 1, 2, 3, …, 10. The sum of these is 55. The cumulative sum is also known as the “running sum.” <span style="float: right; padding-left: 50px;"><a name="3400" href="#3400"><img src="www/icons8-signpost.png" title="Location: 3400" width="12px"></a><span style="color: red; font-size: 6pt;">3400</span></span></p>
<pre><code>##  [1]  0  1  2  3  4  5  6  7  8  9 10</code></pre>
<pre><code>## [1] 55</code></pre>
<pre><code>##  [1]  0  1  3  6 10 15 21 28 36 45 55</code></pre>
<details><summary><strong>Exercise 22.5</strong>: <span><a name="File:%20Exercises/Accum/cumsum.Rmd" href="#3IU9R"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/cumsum.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">3IU9R</span>
</span></summary><p>Consider this sequence: 4, 5, 3, 1, 2</p>
<p><strong>Question A</strong> What is the sum?</p>
<p>    14<span class="mcanswer"> ︎✘ </span>       15<span class="mcanswer"> ✔︎ Yes, we know you can add. We just wanted you to keep in mind what the sum is for the next question, which is just about as easy. </span>       16<span class="mcanswer"> ︎✘ </span>       17<span class="mcanswer"> ︎✘ </span></p>
<p><strong>Question B</strong> What is the cumulative sum?</p>
<ol style="list-style-type: lower-roman">
<li>The sequence 4, 9, 12, 13, 15<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>The sequence 2, 3, 6, 11, 15<span class="mcanswer"> ︎✘ That’s backwards! </span><br>
</li>
<li>The sequence 0, 4, 9, 13, 15<span class="mcanswer"> ︎✘ The first number in the original sequence is 4, so the cumulative sum will start with that. </span>
</li>
</ol>
<p><strong>Question C</strong> Which entry in the cumulative sum matches the sum?</p>
<ol style="list-style-type: lower-roman">
<li>The first<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>The last<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>None of them<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>All of them<span class="mcanswer"> ︎✘ </span>
</li>
</ol></details><p>A good practice with numerical methods is to package them as a <strong><em>function</em></strong>, so that you can easily apply the same method in many different contexts. This is the best way to arrange a calculation so it can be debugged and verified. This is what such a function would look like in R: <span style="float: right; padding-left: 50px;"><a name="3405" href="#3405"><img src="www/icons8-signpost.png" title="Location: 3405" width="12px"></a><span style="color: red; font-size: 6pt;">3405</span></span></p>
<p>Let’s test <code>accumulate()</code>. Since <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code> is the derivative of <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>, accumulating <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code> should give a function that has the same shape as <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-152-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>From the plot, you can see that accumulated version of <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code> has the same shape as <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>. But the two functions are shifted vertically. By how much?</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-153-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>The Euler method gives results that are roughly 0.16 units less than the true answer, <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>. Notice that the error is practically the same for all <span class="math inline">\(t\)</span>. This shows that the Euler accumulated <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code> is practically <code>pnorm(t) - 0.16</code>: a pure vertical shift. (If you look very closely, you’ll see that <code>diff</code> is not exactly a constant. That’s the result of using finite <span class="math inline">\(h\)</span> in the Euler accumulation.) <span style="float: right; padding-left: 50px;"><a name="3410" href="#3410"><img src="www/icons8-signpost.png" title="Location: 3410" width="12px"></a><span style="color: red; font-size: 6pt;">3410</span></span></p>
<details><summary><strong>Exercise 22.5</strong>: <span><a name="File:%20Exercises/Accum/accumulate-R.Rmd" href="#3IUVB"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/accumulate-R.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">3IUVB</span>
</span></summary><p>Copy the <code>accumulate()</code> function from Section <a href="iteration-and-accumulation.html#using-cumsum">27.1.3</a> into a <a href="https://maa-statprep.shinyapps.io/CalcZ-Sandbox/">SANDBOX</a> and make the following plot:
<img src="CalcZ-notes_files/figure-html/unnamed-chunk-391-1.png" width="90%" style="display: block; margin: auto;">
There is a vertical difference between the accumulated points and <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>.</p>
<p><strong>Question A</strong> What happens to this vertical difference if you make <span class="math inline">\(t_0\)</span> smaller (more negative) than <span class="math inline">\(-1\)</span>?</p>
<ol style="list-style-type: lower-roman">
<li>The difference gets smaller.<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>The difference gets bigger.<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>The difference stays the same.<span class="mcanswer"> ︎✘ </span>
</li>
</ol></details>
</div>
</div>
<div id="iteration" class="section level2" number="27.2">
<h2>
<span class="header-section-number">27.2</span> Iteration<a class="anchor" aria-label="anchor" href="#iteration"><i class="fas fa-link"></i></a>
</h2>
<p>There is an important computational strategy behind the Euler method, whether it be implemented on a spreadsheet or in R: <strong><em>iteration</em></strong></p>
<p>“Iteration” means to do something over and over again, or, as defined nicely by the New Oxford American Dictionary:</p>
<blockquote>
<p><em>repetition of a mathematical or computational procedure applied to the result of a previous application</em></p>
</blockquote>
<p>You saw iteration at work in Section <a href="change-accumulation.html#anti-diff-viz">26.2</a> when we turned the discrete sloping segments of the <strong><em>slope-function visualization</em></strong> into continuous, joined line segments. We started with the right endpoint of segment (a). Then we applied a procedure: change the vertical position of segment (b) so that the left end of (b) joins with the right end of (a). Now repeat that, but starting not with the original segment (a) but the joined (a)-(b) segments: move segment (c) vertically until its left end is joined with the rightmost point of the (a)-(b) segments. This produces a continuous (a)-(b)-(c) structure. Repeat again, using (a)-(b)-(c) and joining (d) to that. And so on. Iteration. <span style="float: right; padding-left: 50px;"><a name="3415" href="#3415"><img src="www/icons8-signpost.png" title="Location: 3415" width="12px"></a><span style="color: red; font-size: 6pt;">3415</span></span></p>
<p>Iteration is behind many of the algorithms used throughout mathematics and computation generally. The fundamental structure of iteration involves three things:</p>
<ol style="list-style-type: decimal">
<li>A set of items over which the iteration is to be performed. Call this the <strong><em>iteration set</em></strong>. Examples of iteration sets: the line segments in the slope-function visualization; the cells in a spreadsheet; the individual numbers in a sequence like 0, 1, 2, 3,</li>
<li>An object, called the <strong><em>accumulator</em></strong> to hold the result of the accumulation. This might be in the shape of a single number, or it might be a sequence of things, more or less like the set in (1).</li>
<li>A <strong><em>procedure</em></strong> that takes the accumulator as well as an item from (1) and calculates something, with which to augment the accumulator.</li>
</ol>
<p>To carry out the iteration, you initialize the accumulator in a way that’s appropriate, then apply the procedure to the first item of the set (1), thereby updating the accumulator. Next, move to the second item in the set (1) and update the accumulator. Repeat this for each of the items in the set (1). When you’ve processed each of those items the accumulator holds the result. <span style="float: right; padding-left: 50px;"><a name="3420" href="#3420"><img src="www/icons8-signpost.png" title="Location: 3420" width="12px"></a><span style="color: red; font-size: 6pt;">3420</span></span></p>
<p><strong>Example 1</strong>: Summing a set of numbers.</p>
<ul>
<li>The iteration set is those numbers, for instance, 3, 5, -2, 1, 4.</li>
<li>The accumulator is a single number, which we initialize to 0.</li>
<li>The procedure takes the item from the iteration set and updates the accumulator by adding that item to the accumulator.</li>
</ul>
<p>The accumulator starts out as 0. Then 3 is added to it and the accumulator becomes 3. Then 5 is added to it and the accumulator becomes 8. Next, -2 is added to it and the accumulator becomes 6. The 1 in the iteration set updates the accumulator to 7 and, finally, the last item in the iteration set—4—updates the accumulator to 11. The final result: 11. <span style="float: right; padding-left: 50px;"><a name="3425" href="#3425"><img src="www/icons8-signpost.png" title="Location: 3425" width="12px"></a><span style="color: red; font-size: 6pt;">3425</span></span></p>
<p>Let’s look at how this might be written in base R, even though the R/mosaic software allows you to avoid such constructions.</p>
<pre><code>## [1] 11</code></pre>
<p>Almost all computer languages have a structure like the <strong><em>for loop</em></strong> in R for carrying out the repetition. Learning how to use such things is a fundamental part of computer programming.</p>
<p><strong>Example 2</strong>: The cumulative sum</p>
<p>We’ll use the same iteration set as in the previous example. But the accumulator will have two parts, a <code>running_sum</code> and a set of numbers. As in the summation iteration, we’ll initialize <code>running_sum</code> to zero. The set of numbers will be initialized to the empty set. In addition to updating <code>running_sum</code>, the update procedure will append the running sum to the end of the set of numbers. The process of appending is called <strong><em>concatenation</em></strong>. One of the many ways in R to concatenate the most recent result looks like <span style="float: right; padding-left: 50px;"><a name="3430" href="#3430"><img src="www/icons8-signpost.png" title="Location: 3430" width="12px"></a><span style="color: red; font-size: 6pt;">3430</span></span></p>
<pre><code>set_of_numbers &lt;- c(set_of_numbers, running_sum)</code></pre>
<p>In R, the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> function performs the appending. “<code>c</code>” stands for “concatenate.”</p>
<p>Here’s one way to write the cumulative sum operation in R:</p>
<pre><code>## [1]  3  8  6  7 11</code></pre>
<div class="takenote">
<p>To experienced programmers, the cumulative-sum iteration code listed above will seem odd. That’s because in learning to program they mastered additional features of the programming language like <strong><em>indexing</em></strong>, which enables you to refer to a specific item in a set. Many, many bugs in programs originate in faulty indexing; it’s not always so easy to do right. <span style="float: right; padding-left: 50px;"><a name="3435" href="#3435"><img src="www/icons8-signpost.png" title="Location: 3435" width="12px"></a><span style="color: red; font-size: 6pt;">3435</span></span></p>
<p>Here’s the cumulative-sum iteration in a way that will seem more familiar to experienced programmers:</p>
<pre><code>## [1]  3  8  6  7 11</code></pre>
<p>In programming languages such as Python or C, such a looping style is commonplace. It also works in R, but experienced R programmers know a set of functions such as <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> or <code><a href="https://rdrr.io/r/base/cumsum.html">cumprod()</a></code> or <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code> that enable the programmer to write iteration operations without explicitly showing the loop. Hiding the loop makes the program much smaller and simpler, for instance, the following does the same accumulation as the loop.</p>
<pre><code>## [1]  3  8  6  7 11</code></pre>
<p>Since functions like <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> have been carefully debugged and validated by their authors, they are much more reliable than home-brew loops. In addition, they are programmed to run close to the hardware and are therefore very fast. That’s not an issue with an iteration set containing five numbers, but such sets might well be 100,000 times longer, or more. <span style="float: right; padding-left: 50px;"><a name="3440" href="#3440"><img src="www/icons8-signpost.png" title="Location: 3440" width="12px"></a><span style="color: red; font-size: 6pt;">3440</span></span></p>
</div>
</div>
<div id="accumulating-population-change" class="section level2" number="27.3">
<h2>
<span class="header-section-number">27.3</span> Accumulating population change<a class="anchor" aria-label="anchor" href="#accumulating-population-change"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s return to the prediction of future population to show how it was done. Recall that we started with the total population of the US as estimated by the Census Bureau every ten years from 1790 on.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The Census estimate was a particular and somewhat peculiar way of counting people. For instance, Native Americans were excluded from the count. So the census numbers give a false impression of a small population growing on an empty continent.&lt;/p&gt;"><sup>24</sup></a> <span style="float: right; padding-left: 50px;"><a name="3445" href="#3445"><img src="www/icons8-signpost.png" title="Location: 3445" width="12px"></a><span style="color: red; font-size: 6pt;">3445</span></span></p>
<p>Those numbers are monotonically increasing, so a projection into the future based just on those numbers is bound to give an ever-increasing value. Augmenting the data with our understanding of the mechanisms of population growth, and bringing in additional information from other sources—families are getting smaller on average, people are living longer—we decided to process the census numbers to give us a better representation of growth: the annual per-capita population growth. <span style="float: right; padding-left: 50px;"><a name="3450" href="#3450"><img src="www/icons8-signpost.png" title="Location: 3450" width="12px"></a><span style="color: red; font-size: 6pt;">3450</span></span></p>
<p>Writing “annual per-capita population growth” in explicit units gives “change in population per year per person.” We observed from the historical record that this quantity is decreasing over time in a way that’s reasonably extrapolated into the future by a straight-line function. <span style="float: right; padding-left: 50px;"><a name="3455" href="#3455"><img src="www/icons8-signpost.png" title="Location: 3455" width="12px"></a><span style="color: red; font-size: 6pt;">3455</span></span></p>
<p>That part of the quantity which is “change in population per year” has the units of the derivative with respect to time of population: <span class="math inline">\(\partial_t P(t)\)</span>. In other words, the information that we’re taking as informative for predicting future population growth, the extrapolation of the growth rate, has the form of a derivative. We’re going to transform that derivative into the the population function itself <span class="math inline">\(P(t)\)</span>. This is an absolutely typical use of anti-differentiation. <span style="float: right; padding-left: 50px;"><a name="3460" href="#3460"><img src="www/icons8-signpost.png" title="Location: 3460" width="12px"></a><span style="color: red; font-size: 6pt;">3460</span></span></p>
<p>The annual growth rate in population <span class="math inline">\(\partial_t P(t)\)</span> can be approximated from the once-per-decade data by finite differencing:
<span class="math display">\[\diff{t} P(\text{year}) = \frac{P(\text{year} + 10) - P(\text{year})}{10}\]</span>
The quantity graphed in Figure <a href="change-accumulation.html#fig:pop-growth">26.4</a> is a little different, it is
the population growth rate <strong><em>per capital</em></strong>, that is, population growth rate divided by the population. In terms of derivatives, the quantity we are using for the prediction is the function drawn as a blue line in Figure <a href="change-accumulation.html#fig:pop-growth">26.4</a> we can directly estimate from the data <span class="math inline">\(P(t)\)</span> is
<span class="math display">\[\frac{\partial_t P(t)}{P(t)} = 0.0071 - 0.000120 (t - 2020)\]</span></p>
<p>Someone who has absolutely mastered the rules of differentiation in Block 2 might recognize that <span class="math display">\[\partial_t \ln(P(t)) = \frac{\partial_t P(t)}{P(t)}\]</span>
In other words, our modeling of the data has told us the derivative not of <span class="math inline">\(P(t)\)</span> but of <span class="math inline">\(\ln(P(t))\)</span>. Let’s accumulate that.</p>
<p>The growth rate model is <span class="math display">\[\text{Growth rate model:}\ \ \ \partial_t \ln(P(t)) = 0.0071 - 0.000120(t-2020)\]</span></p>
<p>We’ll start in 2020, when we know <span class="math inline">\(P(t) = 331\)</span> million, so <span class="math inline">\(\ln(P(2020)) = 19.618\)</span>. According to the growth rate model, for the year to 2021, the growth rate will be <span class="math inline">\(0.0071 - 0.000120(2021-2020)n= 0.00698\)</span>$ per year. This means that <span class="math inline">\(\ln(P(2021)) = 19.619 + 0.00698 = 19.6247\)</span>. <span style="float: right; padding-left: 50px;"><a name="3465" href="#3465"><img src="www/icons8-signpost.png" title="Location: 3465" width="12px"></a><span style="color: red; font-size: 6pt;">3465</span></span></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Year <span class="math inline">\(t\)</span>
</th>
<th><span class="math inline">\(P(t)\)</span></th>
<th><span class="math inline">\(\ln(P(t))\)</span></th>
<th>
<span class="math inline">\(\partial_t \ln(P(t))\)</span> (from model)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2020</td>
<td>331M</td>
<td>19.618</td>
<td>0.00698</td>
</tr>
<tr class="even">
<td>2021</td>
<td></td>
<td>19.625</td>
<td>0.00686</td>
</tr>
<tr class="odd">
<td>2022</td>
<td></td>
<td>19.632</td>
<td>0.00674</td>
</tr>
<tr class="even">
<td>2023</td>
<td></td>
<td>19.639</td>
<td>0.00662</td>
</tr>
<tr class="odd">
<td>2024</td>
<td></td>
<td>19.645</td>
<td>0.00650</td>
</tr>
<tr class="even">
<td>2025</td>
<td></td>
<td>19.652</td>
<td>0.00638</td>
</tr>
<tr class="odd">
<td>2026</td>
<td></td>
<td>19.658</td>
<td>0.00626</td>
</tr>
<tr class="even">
<td>2027</td>
<td></td>
<td>19.664</td>
<td>0.00614</td>
</tr>
<tr class="odd">
<td>2028</td>
<td></td>
<td>19.670</td>
<td>0.00602</td>
</tr>
<tr class="even">
<td>2029</td>
<td>351M</td>
<td>19.677</td>
<td>0.00590</td>
</tr>
</tbody>
</table></div>
<p>Performing the accumulation is simply accounting. Our model has told us the 4th column of the table for each year. We the first row of the table: <span class="math inline">\(P(2020) = 331\)</span>M and therefore <span class="math inline">\(\ln(P(2020)) = 19.618\)</span>. To get the <span class="math inline">\(\ln(P(2021)\)</span> row, add the number in the fourth column of previous row. Continue on from each row to the next. Once we have accumulated <span class="math inline">\(\ln(P(t))\)</span>, we can convert it through exponentiation to <span class="math inline">\(P(t)\)</span>. <span style="float: right; padding-left: 50px;"><a name="3470" href="#3470"><img src="www/icons8-signpost.png" title="Location: 3470" width="12px"></a><span style="color: red; font-size: 6pt;">3470</span></span></p>
<div class="objectives">
<ol>
<li>
<strong>[Int-2e]</strong> <em>Determine the units of an anti-derivative given the base function and the variable of integration.</em>
</li>
</ol>
</div>
<div class="objectives">
<ol>
<li>
<strong>[Int-5a]</strong> <em>Determine dimensions and units utilizing a graph.</em>
</li>
<li>
<strong>[Int-5b]</strong> <em>Graph the anti-derivative of a function given the graph of the base function and a single point on the anti-derivative.</em>
</li>
</ol>
</div>
<div class="objectives">
<ol>
<li>
<strong>[Int-2a]</strong> <em>Utilize Euler’s Method to approximate anti-derivatives when the value of is small.</em>
</li>
</ol>
</div>
<details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Accum/rhinosaurus-mute-tv.Rmd" href="#ljCxcH"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/rhinosaurus-mute-tv.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">ljCxcH</span>
</span></summary><p>The result of applying the Euler method to a function is also another function, but it comes in the form of a vector of numbers all ready to be displayed graphically. So keep in mind the the function produced by Euler will be known only over a specified domain, just as the graph of a function covers only the specified domain. For instance, here is the graph of the natural logarithm function over the domain <span class="math inline">\(1 \leq x \leq 21\)</span>.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/dots0-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>The command in the sandbox is a little different than the usual <code>slice_plot()</code>. We’ve added on two things:</p>
<ol style="list-style-type: decimal">
<li><p>An argument <code>npts=11</code> which says to use 11 discrete values of the input in plotting the graph.</p></li>
<li><p>A second graphics layer that shows a dot at each input point where <code>slice_plot()</code> evaluated the function. Behind the seemingly smooth curves that <code>slice_plot()</code> produces is really a discrete set of points each of which is the output of the function at some numerical input.</p></li>
</ol>
<p>In our typical use of <code>slice_plot()</code> we leave out the dots and show only the straight line segments that connect the positions where the dots would be plotted. If the positions are spaced closely enough, your eye will not see the joints between successive straight lines and you will perceive the graph as a smooth curve.</p>
<p><strong>Question A</strong> For the graph of the log function over the domain <span class="math inline">\(1 \leq x \leq 21\)</span> with <code>npts=11</code> (that is, the initial command shown in the sandbox), what is the horizontal spacing between the discrete <span class="math inline">\(x\)</span> values?</p>
<p>    0.5<span class="mcanswer"> ︎✘ </span>       1<span class="mcanswer"> ︎✘ </span>       2<span class="mcanswer"> ✔︎ </span>       4<span class="mcanswer"> ︎✘ </span>       5<span class="mcanswer"> ︎✘ </span></p>
<p>Now take away the <code>npts=</code> argument. This will implicitly set <code>npts</code> to a default value, which is what we have been using for most plots in this course.</p>
<p><strong>Question B</strong> What is the default value of <code>npts</code> in <code>slice_plot()</code>?</p>
<p>    25<span class="mcanswer"> ︎✘ </span>       50<span class="mcanswer"> ︎✘ </span>       100<span class="mcanswer"> ✔︎ </span>       200<span class="mcanswer"> ︎✘ </span>       500<span class="mcanswer"> ︎✘ </span>       1000<span class="mcanswer"> ︎✘ </span></p>
<p>We could use a much larger value for <code>npts</code>, but there is no reason so long as a smaller value produces a graph faithful to the function being graphed.</p>
<p>Keeping the domain the same, <span class="math inline">\(1 \leq x \leq 21\)</span>, plot out a sinusoid with a period of 0.3 using the default <code>npts</code>: <span class="math inline">\(g(x) \equiv \sin(2\pi x/0.3)\)</span>. The graph, which shows about 67 cycles of the sinusoid, will not look much like a sinusoid. In particular, although the sine function should reach from -1 to 1 over each cycle, the graph does not.</p>
<p><strong>Question C</strong> How large should <code>npts</code> be in order for each of the 67 cycles in the graph to come close enough to -1 and 1 that you cannot easily see the discrepancy?</p>
    125<span class="mcanswer"> ︎✘ </span>       150<span class="mcanswer"> ︎✘ </span>       200<span class="mcanswer"> ︎✘ </span>       400<span class="mcanswer"> ︎✘ </span>       800<span class="mcanswer"> ✔︎ </span>       1600<span class="mcanswer"> ︎✘ </span>       3200<span class="mcanswer"> ︎✘ </span>
</details><details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Accum/falcon-hurt-pot.Rmd" href="#rfO0EG"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/falcon-hurt-pot.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">rfO0EG</span>
</span></summary><p>Methods such as Euler are tedious, ideal for the computer. So let’s look at some basic R functions for implementing the Euler Method when we know the function to be anti-differentiated <span class="math inline">\(f(x)\)</span>, the step size <span class="math inline">\(h\)</span>, and the domain <span class="math inline">\(a \leq x \leq b\)</span>. At the heart of the implementation is a function <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code>, the “cumulative sum.” This does something very simple. The cumulative sum of the sequence 1, 2, 3, 4 is another sequence: 1, 3, 6, 10.</p>
<p>The following code has commands for using <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> to approximate the anti-derivative of a function <span class="math inline">\(f()\)</span> over the domain <span class="math inline">\(a \leq x \leq b\)</span></p>
<p>Here is a function:</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">~</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p>Using a <a href="https://maa-statprep.shinyapps.io/CalcZ-Sandbox/">SANDBOX</a>, find and plot the anti-derivative of <span class="math inline">\(g(x)\)</span> over the domain <span class="math inline">\(-6 \leq x \leq 6\)</span>.</p>
Your task: Describe the shape of <span class="math inline">\(G(x)\)</span>. Your description can be one word from earlier in the book, if you choose it carefully. If your graph looks like a straight line, you did not appropriately change the domain above.
</details><details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Accum/wind-power.Rmd" href="#ikgl"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/wind-power.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">ikgl</span>
</span></summary><p>The function <code>windspeed(t)</code> records wind speed at the site of a wind-turbine farm over one day, that is, <span class="math inline">\(0 \leq t \leq 24\)</span> hours. The function <code>speed2power(s)</code> is the production function for the model of wind turbine used at the farm: the input is speed in miles per hour, the output is in kilowatts. (Both these functions were created for this exercise. They are not about a real turbine at a real wind farm, but are somewhat realistic.) Hint: you can nest a function inside of another function. For instance, if I had a function (‘solarpanelpower’) that calculates the amount of power a solar panel generates and another function (‘sunlight’) that tells me the amount of sunlight at time of the day (‘TOD’). I could evaluate this in one step like the following: ‘solarpanelpower(sunlight(TOD)).’ This would give me the amount of power from the solar panel based upon the time of the day.</p>
<p>Your task, find the <em>total energy</em> generated over the 24-hour period by the turbine. Reminder: energy <span class="math inline">\(E\)</span> is electric power multiplied by time. Or, more usefully for this problem, the increment energy <span class="math inline">\(dE\)</span> generated at time <span class="math inline">\(t\)</span> is the product of power at time <span class="math inline">\(t\)</span> multiplied by the increment of time <span class="math inline">\(dt\)</span>, that is, <span class="math inline">\(dE = p(t) dt\)</span>. Consequently, <span class="math display">\[E = \int_\mbox{morning}^\mbox{night} p(t) dt\]</span> where “morning” should really be 00:00 h and night 24:00 h on the day in question.</p>
<p>We don’t have an algebraic formula for <code>windspeed(t)</code> even though it is a function. You can use <code>antiD()</code> to find the anti-derivative of the electric power function.</p>
<p>The answer you compute should be saved to the name <code>result</code>. The units will be in kWh – kilowatt hours.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/wind2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question A</strong> Wind turbines of this type have a maximum power rating of 5000 kilowatts. Was this rating exceeded at any point during the day?</p>
<ol style="list-style-type: lower-roman">
<li>The maximum instantaneous power was about 3500 kilowatts<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>The maximum instantaneous power was about 1100 kilowatts<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>That threshold was reached about 9 AM<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>That threshold was exceeded about 8 AM<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>The maximum instantaneous power cannot be determined from the information given.<span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<p><strong>Question B</strong> At the maximum power rating of 5000 kilowatts, what’s the theoretical maximum amount of energy produced by the turbine over a 24-hour day?</p>
<ol style="list-style-type: lower-roman">
<li>5000 * 24 kilowatt-hours<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>5000 / 24 kilowatt-hours<span class="mcanswer"> ︎✘ The units, kilowatt hours, should remind you that power is multiplied by time. </span><br>
</li>
<li>5000 kilowatts<span class="mcanswer"> ︎✘ That’s the <strong>power</strong> rating. We want to know the amount of <strong>energy</strong>. </span><br>
</li>
<li>Can’t be determined from the information given.<span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<p><strong>Question C</strong> About what fraction of the theoretical maximum energy did the wind turbine generate over the 24-hour period?</p>
<ol style="list-style-type: lower-roman">
<li>About 2.5%<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>About 10%<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>About 25%<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>About 50%<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>Can’t be determined from the information given.<span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<p><strong>Question D</strong> A peak time for residential energy consumption is from 7 am to 9 am. The price at which you can sell electrical energy to the grid operator is $0.09 per kilowatt-hour. At that price, how much would the energy produced from 7-9 am be worth?</p>
<ol style="list-style-type: lower-roman">
<li>About 20 cents.<span class="mcanswer"> ︎✘ That would be the answer if the turbine generated only 1 kilowatt of power during that period. </span><br>
</li>
<li>About $150<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>About $350<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>About $650<span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<p><strong>Question E</strong> What’s the average wind speed over the 24-hour period?</p>
<p>    About 5 mph<span class="mcanswer"> ✔︎ </span>       About 7 mph<span class="mcanswer"> ︎✘ </span>       About 9 mph<span class="mcanswer"> ︎✘ </span></p>
<p><strong>Question F</strong> Wind speed fluctuates a lot, but imagine that the wind blew steadily at the average wind speed from the previous problem. How much energy would be generated over the 24-hour period?</p>
<ol style="list-style-type: lower-roman">
<li>0 kilowatt hours<span class="mcanswer"> ✔︎ That wind wouldn’t be strong enough to turn the turbine. </span><br>
</li>
<li>500 kilowatt hours<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>1000 kilowatt hours<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>10,000 kilowatt hours<span class="mcanswer"> ︎✘ </span>
</li>
</ol></details><details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Accum/heat-engine.Rmd" href="#DKwksA"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/heat-engine.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">DKwksA</span>
</span></summary><p>In the 1660s, John Boyle made use of then-new instrumentation to measure gas pressure. He discovered what’s now called <em>Boyle’s Law</em>, which says that, at constant temperature in a closed system, pressure times volume is a constant:</p>
<p><span class="math display">\[PV = const\]</span>
In the 1720s, Daniel Fahrenheit developed the first reliable thermometer consisting of a column of mercury in a glass straw. He developed a temperature scale which divided the range from freezing to boiling into 180 small units, which he called “degrees,” as was traditional in measuring angles. (In 1742, Anders Celsius created another scale with freezing at 0 and 100 small units—still called “degrees”—between freezing and boiling.</p>
<p>With the availability of reliable thermometers, scientists started to consider the role of temperature in the relationship between pressure and volume. Their many discoveries were eventually synthesized into a “combined gas law” and then into an “ideal gas law” which famously states:
<span class="math display">\[PV = nRT .\]</span>
Here, <span class="math inline">\(n\)</span> is “amount” of gas, quantified as the number of moles of the gas in the container, <span class="math inline">\(T\)</span> is temperature, and <span class="math inline">\(R\)</span> is the “ideal gas constant”:
<span class="math display">\[R = 8.314  \mbox{J}/(\mbox{K}\ \mbox{mol})\]</span>
The “mol” cancels out the dimension of <span class="math inline">\(n\)</span>, the <span class="math inline">\(K\)</span> cancels out the dimension of <span class="math inline">\(T\)</span>, leaving us with <span class="math inline">\(PV\)</span> having the dimension of energy (Joules). The temperature <span class="math inline">\(T\)</span> is measured in degrees Kelvin, which is just like Celsius but moving the location of 0 from freezing to … well … the hypothetical temperature when <span class="math inline">\(PV=0\)</span>, which can be estimated by extrapolating measurements of <span class="math inline">\(PV(T)\)</span> (that is, <span class="math inline">\(PV\)</span> as a function of <span class="math inline">\(T\)</span>) to the <span class="math inline">\(T\)</span> where <span class="math inline">\(PV = 0\)</span>.</p>
<p><strong>Question A</strong> It’s convenient to have specific units in mind for pressure and volume. Since <span class="math inline">\(P V\)</span> gives energy, let’s arrange <span class="math inline">\(P\)</span> and <span class="math inline">\(V\)</span> to have units such that when multiplied the result is Joules. What is the expression of the dimension Joule in terms of the SI system, that is, time in seconds, length in meters, and mass in kg? Hint: use the above paragraph and knowing that the units for energy are consistent for potential, kinetic, or other types of energy.</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(kg m^2 s^{-2}\)</span><span class="mcanswer"> ✔︎ </span><br>
</li>
<li>
<span class="math inline">\(kg m / s\)</span><span class="mcanswer"> ︎✘ This is the units of momentum. </span><br>
</li>
<li>
<span class="math inline">\(kg^2 m^2 s^3\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(m^2 / s^2\)</span><span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<p><strong>Question B</strong> In the SI units system, volume has units of cubic meters: <span class="math inline">\(m^3\)</span>. What are the SI units for pressure in terms of kg, m, and s? The units of your answer to this question times the units for pressure should be equivilent to your answer from the previous question.</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(kg m^{-1} s^{-2}\)</span><span class="mcanswer"> ✔︎ </span><br>
</li>
<li>
<span class="math inline">\(kg m^1 s^{-2}\)</span><span class="mcanswer"> ︎✘ This is the units of force </span><br>
</li>
<li>
<span class="math inline">\(kg^2 m^1 s^2\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(m s^2 / kg\)</span><span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<p>For use in calculus, it’s helpful to re-write the Ideal Gas Law in functional form. There are several ways to do this. For instance, if we wanted to measure the number of moles of gas in a container, we could use the function <span class="math inline">\(n(P, V, T) = PV/RT\)</span>. Here, we’re going to focus on pressure as a function of the other quantities:
<span class="math display">\[P(n, V, T) = nRT/V.\]</span>
Now consider a very simple machine consisting of a cylinder, closed on one end and sealed by a movable piston at the other, as in this picture.</p>
<div class="inline-figure"><img src="www/Piston.gif" width="90%" style="display: block; margin: auto;"></div>
<p>Source: <a href="https://commons.wikimedia.org/w/index.php?curid=375503">R. Castelnuovo - Own work, CC BY-SA 3.0</a></p>
<p>The machine in the picture is more complicated than the simple machine we want to model. The picture includes two small valves at the top of the cylinder connected each to a pipe.</p>
<p>Our machine has no valves and no pipes. The cylinder is charged with gas when it is manufactured. After that, nothing material goes in or out of the closed cylinder/piston system.</p>
<p>When you push on the cylinder, the volume available for the gas gets smaller and the pressure increases. When you let the cylinder push on you, the volume available gets bigger and the pressure decreases. The amount of gas, <span class="math inline">\(n\)</span>, never changes. For simplicity, we’ll imagine that <span class="math inline">\(n=1\)</span> and that the gas is N<span class="math inline">\(_2\)</span>. This means the mass of the gas is 0.028 kg.</p>
<p>And, to simplify even more, let’s insist that the temperature of the cylinder and its gaseous content does not change from room temperature: 293<span class="math inline">\(^\circ\)</span> Kelvin.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-397-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>If you start in a high-volume, low-pressure state and push the piston to move to a low-volume, high-pressure state at the same temperature, you will be putting energy into the machine.</p>
<p>The “area” of each little box in the graph, that is, pressure times volume,
<strong>Question C</strong> How much energy (in Joules) corresponds to one small rectangle of area in the graph?</p>
<p>    500 J<span class="mcanswer"> ︎✘ pick a gray box, what are its dimensions? </span>       625 J<span class="mcanswer"> ✔︎ </span>       2500 J<span class="mcanswer"> ︎✘ pick a gray box, what are its dimensions? </span>       25,000 J<span class="mcanswer"> ︎✘ This is four gray boxes, not one </span></p>
<p><strong>Question D</strong> By counting rectangles in the graph, estimate how much energy needs to be put into the machine when the volume changes from 7.5 m<span class="math inline">\(^3\)</span> to 2.5 m<span class="math inline">\(^3\)</span> at a temperature of 300 K?</p>
<p>    1000 J<span class="mcanswer"> ︎✘ </span>       3000 J<span class="mcanswer"> ✔︎ </span>       5000 J<span class="mcanswer"> ︎✘ </span>       10,000 J<span class="mcanswer"> ︎✘ </span></p>
<p>Now that you have compressed the gas in the cylinder, by doing work on it, let’s heat up the machine to 1200K.</p>
<p><strong>Question E</strong> What will be the pressure of the gas when the volume of the machine is 2.5 m<span class="math inline">\(^3\)</span> at temperature 1200 K? (The units will be kg m$^{-1} <span class="math inline">\(s^{-2}\)</span>)</p>
<p>    1000<span class="mcanswer"> ︎✘ </span>       2000<span class="mcanswer"> ︎✘ </span>       3000<span class="mcanswer"> ︎✘ </span>       4000<span class="mcanswer"> ✔︎ </span></p>
<p><strong>Question F</strong> Starting with the machine at 1200K and a volume of 2.5 m<span class="math inline">\(^3\)</span>, how much energy will the machine transfer to you when it expands to 7.5 m<span class="math inline">\(^3\)</span>? Estimate this by counting squares in the graph.</p>
<ol style="list-style-type: lower-roman">
<li>about 5000 J<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>about 10,000 J<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>about 50,000 J<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>about 100,000 J<span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<p>The net work done by the machine in completing the cycle, shifting from compression at low temperature to expansion at high temperature, is the difference between the energy put out by the machine when expanding and the energy put into the machine to compress the gas. Such a machine is called a “heat engine” since it turns a source of high temperature and a source of low temperature into energy.</p>
<p>In a <a href="https://maa-statprep.shinyapps.io/CalcZ-Sandbox/">SANDBOX</a>, evaluate the code below. The first line defines a function <span class="math inline">\(P(V, T)\)</span> with default <span class="math inline">\(n=1\)</span> mole of gas. Anti-differentiate <span class="math inline">\(P()\)</span> with respect to <span class="math inline">\(V\)</span> then calculate the energy needed to compress the cylinder at the low temperature, that is <span class="math display">\[\int_{7.5}^{2.5} P(V, T=300) dV .\]</span> Call this numerical result <code>compress_energy</code>.</p>
<p>Similarly, calculate the energy done by the machine in the high-temperature expansion <span class="math display">\[\int_{2.5}^{7.5} P(V, T=1200) dV .\]</span> Call this numerical result <code>expand_energy</code>.</p>
<p>You may want to make a graph of your <span class="math inline">\(P(V, T)\)</span> function to check that it is right. Also, check that the integrals are right by comparing them to the rough estimate you made earlier by counting squares.</p>
</details><details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Accum/Graph-anti.Rmd" href="#HJWsexj"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/Graph-anti.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">HJWsexj</span>
</span></summary><p>In this exercise, you are going to use the “Graph-antiD” web app which enables you to visualize the anti-derivative function in terms of areas. To use the app, click-drag-and-release to mark part of the domain of the function being displayed.</p>
<div class="todo">
<p>Add a picture of the app and a link to it.</p>
</div>
<p>To answer these questions correctly, <strong>you must set the “Shape of function” box to 864</strong>.</p>
<p>Remember that the graph shows <span class="math inline">\(f(t)\)</span>, while these questions are about <span class="math inline">\(F(t) = \int f(t) dt\)</span>.</p>
<p><strong>Question A</strong> At which of the following values of t does <span class="math inline">\(F(t)\)</span> have a positive slope?</p>
<p>    -3<span class="mcanswer"> ︎✘ The slope of <span class="math inline">\(F(t)\)</span> is what function? </span>       0<span class="mcanswer"> ︎✘ <span class="math inline">\(f(t)\)</span> is negative here, so the accumulated area will be getting more negative. </span>       3<span class="mcanswer"> ✔︎ Right. <span class="math inline">\(f(t)\)</span> is positive here, so the accumulated area <span class="math inline">\(F(t)\)</span> will be growing, which means that <span class="math inline">\(F(t)\)</span> has a positive slope. </span></p>
<p><strong>Question B</strong> At which of the following values of t is <span class="math inline">\(F(t)\)</span> concave down?</p>
<p>    -3<span class="mcanswer"> ✔︎ Good. The concavity of <span class="math inline">\(F(t)\)</span> has the sign of the second derivative <span class="math inline">\(\partial_{tt} F(t)\)</span>. But this second derivative of <span class="math inline">\(F(t)\)</span> is the first derivative of <span class="math inline">\(f(t)\)</span>. So <span class="math inline">\(F(t)\)</span> is concave down when the slope of <span class="math inline">\(f(t)\)</span> is negative. </span>       0<span class="mcanswer"> ︎✘ </span>       3<span class="mcanswer"> ︎✘ </span></p>
<p><strong>Question C</strong> Which of the following statements about <span class="math inline">\(F(t)\)</span> is true at the point t=3.5?</p>
<ol style="list-style-type: lower-roman">
<li>There is a maximum value at this point<span class="mcanswer"> ︎✘ This is true about <span class="math inline">\(f(t)\)</span> not <span class="math inline">\(F(t)\)</span> </span><br>
</li>
<li>The slope changes from positive to negative<span class="mcanswer"> ︎✘ This is true about <span class="math inline">\(f(t)\)</span> not <span class="math inline">\(F(t)\)</span> </span><br>
</li>
<li>The concavity changes from concave up to concave down<span class="mcanswer"> ✔︎ </span>
</li>
</ol></details><details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Accum/computing-and-antiD.Rmd" href="#exkews"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/computing-and-antiD.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">exkews</span>
</span></summary><p>We introduced anti-differentiation through the algebra of our basic modeling functions. With those functions, it’s pretty easy to see that the derivative of the anti-derivative is the original function, as in <span class="math display">\[\partial_x \int \sin(x) dx = \partial_x [-\cos(x)] = \sin(x)\]</span></p>
<p>Later in the course, you’ll see somewhat more complicated functions where the anti-derivative can be found using some technique or another. (Student’s often pronounce “a technique” as “a trick,” at least until they become familiar it.) For many students, learning the algebra of anti-differentiating complicated functions is the hardest part of the course and drains away their confidence in their calculus abilities. That’s a shame, because there are other ways than algebra to compute anti-derivatives and also functions for which no algebraic anti-derivative is possible.</p>
<p>An important idea in computing is “abstraction.” Abstraction means, in computer science, that you don’t need to know the internal details of an operation in order to use it. For instance, in computing <code><a href="https://rdrr.io/r/base/Trig.html">sin(x)</a></code>, all you need to know is that <code>x</code> should be numeric. The particular algorithm used to do the calculation is, ideally, irrelevant to the user.</p>
<p>We have abstracted anti-differentiation into a single R function, called <code>antiD()</code>. As you know mathematically, anti-differentiation is an operation performed on a function with respect to one of the arguments to the function. It’s the same with <code>antiD()</code>: you need to specify the function and the “with respect to” variable. You do that in exactly the same way as you do with the <code><a href="https://rdrr.io/r/stats/deriv.html">D()</a></code> operator used for differentiation, with a <em>tilde expression</em>. (<code>makeFun()</code> also uses tilde expressions.)</p>
<p>For example:</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu">antiD</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span>
<span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">antiD</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">k</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x</span><span class="op">/</span><span class="va">P</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>, k<span class="op">=</span><span class="fl">2</span>, P<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu">antiD</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">t</span><span class="op">^</span><span class="fl">2</span>, <span class="op">-</span><span class="va">t</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">~</span> <span class="va">t</span><span class="op">)</span></code></pre></div>
<p>As you expect, <code>f1</code>, <code>f2</code>, and <code>f3</code> are all functions. You evaluate them in the usual way, reducing the calculation of a definite integral to a difference of two evaluations of the functions, for instance:</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">f1</span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">f1</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">f2</span><span class="op">(</span><span class="fl">12</span>, k<span class="op">=</span><span class="fl">2</span>, P<span class="op">=</span><span class="fl">4</span> <span class="op">)</span> <span class="op">-</span> <span class="fu">f2</span><span class="op">(</span><span class="fl">5</span>, k<span class="op">=</span><span class="fl">2</span>, P<span class="op">=</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1.404e-05</code></pre>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">f3</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">-</span> <span class="fu">f3</span><span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 20.333</code></pre>
<p><code>antiD()</code> is an example of computing abstraction because you do not need to know what is going on internally. All you need to know is how to hand a function and a with-respect-to variable as arguments, and that the returned result will be a function of the with-respect-to variable (as well as any other variables in the original function).</p>
<p>For some very simple functions, like <code><a href="https://rdrr.io/r/base/Trig.html">sin(x)</a></code>, the function returned by <code>antiD()</code> will be familiar:</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f1</span></code></pre></div>
<pre><code>## function (x, C = 0) 
## -cos(x) + C
## &lt;bytecode: 0x7fee90b87ee8&gt;</code></pre>
<p>For functions with symbolic parameters, such as in <code>f2()</code>, the anti-derivative function will have the with-respect-to variable as the first argument and any remaining variables as named arguments in no particular order.</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f2</span></code></pre></div>
<pre><code>## function (x, k = 2, P = 4, C = 0) 
## {
##     numerical_integration(.newf, .wrt, as.list(match.call())[-1], 
##         formals(), from, ciName = intC, .tol)
## }
## &lt;environment: 0x7fee92be3c90&gt;</code></pre>
<p>For such functions with parameters, to evaluate the anti-derivative for at a numerical input <code>x</code> requires that all the parameters also be given numerical values. In <code>f2()</code>, defaults for these numerical parameters were assigned at the time of creation, but you can use other values for them whenever you evaluate the anti-derivative.</p>
<p>The function returned by <code>antiD()</code> often will appear mysterious, as in <code>f2()</code>. Following the principle of abstraction, you don’t have to know or understand the internal details of the function’s algorithm. You only need to know how to use the function. One way to use it is to evaluate it at specific numerical inputs. Another way to use it is to construct other functions, as in this entirely made up and probably useless example:</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">D</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="fu">f2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu">f2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span>
<span class="fu">slice_plot</span><span class="op">(</span><span class="fu">g</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>, <span class="fu">domain</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, npts<span class="op">=</span><span class="fl">500</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-404-1.png" width="90%" style="display: block; margin: auto;"></div>
The abstraction built in to <code>antiD()</code> function is not perfect. <code>antiD()</code> knows about certain pathologies of functions, such as <span class="math inline">\(g(x) = 1/x\)</span>, which isn’t defined at <span class="math inline">\(x=0\)</span>, but doesn’t necessarily handle them in the way a skilled, thinking person would. Still, when you need an anti-derivative and don’t see any way to get an algebraic expression for it, <code>antiD()</code> often lets you get on with your work.
</details><details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Accum/lessons-from-euler.Rmd" href="#KELSE"><img src="www/icons8-signpost.png" title="Location: Exercises/Accum/lessons-from-euler.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">KELSE</span>
</span></summary><p>Some things to learn from the Euler Method:</p>
<ol style="list-style-type: decimal">
<li><p>Anti-differentiation is no more than <em>accumulating</em> the <span class="math inline">\(f(x)\)</span>, after multiplying it by an appropriate step size <span class="math inline">\(h\)</span>.</p></li>
<li><p>Since <span class="math inline">\(h\)</span> has the same dimension as the input <span class="math inline">\(x\)</span>, the dimension of the anti-derivative will be [<span class="math inline">\(f(x)\)</span>][<span class="math inline">\(h\)</span>].</p></li>
</ol>
<p>In our description of the Euler method, we made the assumption that when integrating <span class="math inline">\(f(x)\)</span> over the domain <span class="math inline">\(a \leq x \leq b\)</span>, we can set <span class="math inline">\(F(a) = 0\)</span>. There’s nothing fatal about this assumption, but we should admit that we could have used any value we like for <span class="math inline">\(F(a)\)</span>. Using a non-zero value of <span class="math inline">\(F(a)\)</span> would simply add the same number to every point in the output of the Euler Method.</p>
<ol start="3" style="list-style-type: decimal">
<li>Any chosen number for <span class="math inline">\(F(a)\)</span> generates an authentic, genuine anti-derivative of <span class="math inline">\(f(x)\)</span>. Since <span class="math inline">\(F(a)\)</span> can be any number at all, there are infinitely many anti-derivatives of any function <span class="math inline">\(f(x)\)</span>. They all have the same shape, but differ from one another by a constant.</li>
</ol>
<p>This constant, which amounts to the choice of <span class="math inline">\(F(a)\)</span>, is called the “constant of integration.” In many modeling tasks involving anti-differentiation, we need to find a choice for the “constant of integration” (that is, <span class="math inline">\(F(a)\)</span>) that fits with what else we know about the system being modeled.</p>
<p><strong>Essay question tmp-38</strong>: Briefly restate these “Lessons from Euler” in your own words.</p>
<p><strong>Question A</strong> Suppose we want to give a formula for a function <span class="math inline">\(F(x)\)</span> which is to be the anti-derivative of the function <span class="math inline">\(f(x) \equiv x^2\)</span>. We don’t need the Euler method for this simple problem, the answer is <span class="math inline">\(F(x) \equiv \frac{1}{3} x^3 + C\)</span>. We want to give the correct numeric value for <span class="math inline">\(C\)</span> so that <span class="math inline">\(F(3) = 12\)</span>. What should <span class="math inline">\(C\)</span> be?</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(C\)</span> should be -3.<span class="mcanswer"> ︎✘ This would give us <span class="math inline">\(F(3) = \frac{1}{3} 3^3 - 3\)</span>, which is 6, not the <span class="math inline">\(F(3) = 12\)</span> asked for. </span><br>
</li>
<li>
<span class="math inline">\(C\)</span> should be 3.<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>
<span class="math inline">\(C\)</span> should be 12.<span class="mcanswer"> ︎✘ This would give us <span class="math inline">\(F(3) = \frac{1}{3} 3^3 + 12\)</span>, which is 21, not the <span class="math inline">\(F(3) = 12\)</span> asked for. </span>
</li>
</ol></details>
</div>
<div id="any-use-for-this" class="section level2" number="27.4">
<h2>
<span class="header-section-number">27.4</span> Any use for this?<a class="anchor" aria-label="anchor" href="#any-use-for-this"><i class="fas fa-link"></i></a>
</h2>
<p>To construct an anti-derivative with the Euler Method, you need:</p>
<ol style="list-style-type: decimal">
<li>Obviously … The function to be anti-differentiated, which we’ll call <span class="math inline">\(f(t)\)</span> in the example.</li>
<li>Specific numerical values for all parameters of the function, e.g. the <span class="math inline">\(k\)</span> in <span class="math inline">\(e^{kt}\)</span> or the <span class="math inline">\(P\)</span> in <span class="math inline">\(\sin(2\pi t/P)\)</span>.</li>
<li>The domain over which you want to know the anti-derivative.</li>
<li>A numerical value for a “step size” <span class="math inline">\(h\)</span>. This should be “small,” but “small” depends on the problem being tackled, just as you saw with the graphics in the previous problem.</li>
</ol>
<p>To see where the Euler Method comes from, recall that anti-differentiation is “undoing” differentiation and remember the discrete time version of differentiation:
<span class="math display">\[\partial_x f(x) \approx \frac{f(x+h) - f(x)}{h}\]</span>
To make it clear where the anti-derivative comes in to this, let’s rewrite the finite-difference formula using a different notation: <span class="math inline">\(f(x)\)</span> will be the function to be anti-differentiated and <span class="math inline">\(F(x)\)</span> will be the result of the anti-differentiation of <span class="math inline">\(f(x)\)</span>. Using this notation:
<span class="math display">\[f(x) \approx \frac{F(x+h) - F(x)}{h}\]</span>
You can see that <span class="math inline">\(f(x)\)</span> is the derivative of <span class="math inline">\(F(x)\)</span>, but here we know <span class="math inline">\(f(x)\)</span> but do not (yet) know <span class="math inline">\(F(x)\)</span>. To find <span class="math inline">\(F(x)\)</span> at a series of discrete values of <span class="math inline">\(x\)</span> spaced by <span class="math inline">\(h\)</span>, re-arrange the equation:
<span class="math display">\[F(x + h) \approx F(x) + h f(x)\ \ \  \ \ \mbox{Euler method formula}\]</span></p>
<p>As an example of using this formula, let’s anti-differentiate <span class="math inline">\(\sin(2\pi x/0.3)\)</span> over the domain <span class="math inline">\(1 \leq x \leq 21\)</span> with a step size of <span class="math inline">\(h=0.01\)</span></p>
<p>We start at <span class="math inline">\(x=1\)</span> and</p>
<ol style="list-style-type: lower-roman">
<li>Since we don’t yet know <span class="math inline">\(F(x)\)</span>, let’s make our life simple and assume that <span class="math inline">\(F(x=1) \equiv 0\)</span>. (You will see why this choice works later on. In fact, you could use any value you like for <span class="math inline">\(F(x=1)\)</span>.)</li>
<li>We do know <span class="math inline">\(f(x)\)</span>. Calculate <span class="math inline">\(f(x=1)\)</span>. This comes out to be <code><a href="https://rdrr.io/r/base/Trig.html">sin(2*pi*1 / 0.3)</a></code> or 0.866.</li>
<li>Plug in the value of <span class="math inline">\(f(x=1)\)</span> from step (ii) to the Euler method formula in order to calculate <span class="math inline">\(F(1 + 0.01)\)</span>. The formula, and our assumed value <span class="math inline">\(F(1) = 0\)</span>, gives <span class="math display">\[F(1 + 0.01) = 0 + 0.01 \times 0.866 = 0.00866\]</span>
</li>
<li>Now move on to the next time step. We know <span class="math inline">\(f(1.01) = 0.743\)</span> and <span class="math inline">\(F(1.01) = 0.00866\)</span>. We use the Euler method formula to find
<span class="math display">\[F(1.02) = F(1.01) + 0.01\times 0.743 =  0.00866 + 0.00743 = 0.01609\]</span>
</li>
</ol>
<p><strong>Question B</strong> What is the value of <span class="math inline">\(F(1.03)\)</span>?</p>
<ol style="list-style-type: lower-roman">
<li>
<code>0.01609 + 0.01*0.588</code><span class="mcanswer"> ✔︎ </span><br>
</li>
<li>
<code>0.01609 + 0.01*0.743</code><span class="mcanswer"> ︎✘ You should be using <span class="math inline">\(f(1.02)\)</span>, not <span class="math inline">\(f(1.01)\)</span>. </span><br>
</li>
<li>
<code>0.00866 + 0.01*0.743</code><span class="mcanswer"> ︎✘ You should be using <span class="math inline">\(F(1.02)\)</span>, not <span class="math inline">\(F(1.01)\)</span>. </span><br>
</li>
<li>
<code>0.00866 + 0.01*0.588</code><span class="mcanswer"> ︎✘ You should be using <span class="math inline">\(F(1.02)\)</span> and <span class="math inline">\(f(1.02)\)</span>, not <span class="math inline">\(F(1.01)\)</span> and <span class="math inline">\(f(1.01)\)</span>. </span>
</li>
</ol>
<p><strong>Question C</strong> How many steps will it take from <span class="math inline">\(x=1.03\)</span> to reach <span class="math inline">\(x=1.05\)</span>?</p>
<p>    1<span class="mcanswer"> ︎✘ </span>       2<span class="mcanswer"> ✔︎ </span>       3<span class="mcanswer"> ︎✘ </span>       4<span class="mcanswer"> ︎✘ </span>       5<span class="mcanswer"> ︎✘ </span></p>
<p><strong>Question D</strong> What is <span class="math inline">\(F(1.05)\)</span>?</p>
<p>    0.028<span class="mcanswer"> ︎✘ That’s <span class="math inline">\(F(1.04)\)</span>. </span>       0.030<span class="mcanswer"> ✔︎ </span>       0.032<span class="mcanswer"> ︎✘ </span>       0.033<span class="mcanswer"> ︎✘ </span></p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="change-accumulation.html"><span class="header-section-number">26</span> Change and accumulation</a></div>
<div class="next"><a href="net-change.html"><span class="header-section-number">28</span> Accumulation as net change</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#iteration-and-accumulation"><span class="header-section-number">27</span> Iteration and accumulation</a></li>
<li>
<a class="nav-link" href="#automating-euler"><span class="header-section-number">27.1</span> Automating Euler</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#euler-as-a-spreadsheet"><span class="header-section-number">27.1.1</span> Euler as a spreadsheet</a></li>
<li><a class="nav-link" href="#using-antid"><span class="header-section-number">27.1.2</span> Using antiD()</a></li>
<li><a class="nav-link" href="#using-cumsum"><span class="header-section-number">27.1.3</span> Using cumsum()</a></li>
</ul>
</li>
<li><a class="nav-link" href="#iteration"><span class="header-section-number">27.2</span> Iteration</a></li>
<li><a class="nav-link" href="#accumulating-population-change"><span class="header-section-number">27.3</span> Accumulating population change</a></li>
<li><a class="nav-link" href="#any-use-for-this"><span class="header-section-number">27.4</span> Any use for this?</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/dtkaplan/CalcZ-notes/blob/master/Accum-step-by-step.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/dtkaplan/CalcZ-notes/edit/master/Accum-step-by-step.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>CalcZ Student Notes</strong>" was written by Daniel Kaplan. It was last built on 2021-07-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
