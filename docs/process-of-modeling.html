<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Process of modeling | CalcZ Student Notes</title>
  <meta name="description" content="Textbook for Math 141Z/142Z for 2021-2022" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Process of modeling | CalcZ Student Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Textbook for Math 141Z/142Z for 2021-2022" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Process of modeling | CalcZ Student Notes" />
  
  <meta name="twitter:description" content="Textbook for Math 141Z/142Z for 2021-2022" />
  

<meta name="author" content="Daniel Kaplan" />


<meta name="date" content="2021-06-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="params-intro.html"/>
<link rel="next" href="fun-slopes.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<span class="math inline">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}\)
</span>


<!-- see https://www.homepages.ucl.ac.uk/~ucahmto/elearning/2019/09/14/bookdown.html-->


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/CalcZ-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">CalcZ</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to calculus</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computing-and-apps"><i class="fa fa-check"></i>Computing and apps</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#exercises-and-feedback"><i class="fa fa-check"></i>Exercises and feedback</a></li>
</ul></li>
<li class="part"><span><b>I Block 1: Functions and quantity</b></span></li>
<li class="chapter" data-level="" data-path="outline-of-block-1.html"><a href="outline-of-block-1.html"><i class="fa fa-check"></i>Outline of Block 1</a></li>
<li class="chapter" data-level="1" data-path="change.html"><a href="change.html"><i class="fa fa-check"></i><b>1</b> Change</a>
<ul>
<li class="chapter" data-level="1.1" data-path="change.html"><a href="change.html#quantity-vs-number"><i class="fa fa-check"></i><b>1.1</b> Quantity vs number</a></li>
<li class="chapter" data-level="1.2" data-path="change.html"><a href="change.html#functions"><i class="fa fa-check"></i><b>1.2</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html"><i class="fa fa-check"></i><b>2</b> Structure of a function</a>
<ul>
<li class="chapter" data-level="2.1" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#inputs-to-output"><i class="fa fa-check"></i><b>2.1</b> Inputs to output</a></li>
<li class="chapter" data-level="2.2" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#a-bureaucratic-analogy"><i class="fa fa-check"></i><b>2.2</b> A bureaucratic analogy</a></li>
<li class="chapter" data-level="2.3" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#domain-input-space"><i class="fa fa-check"></i><b>2.3</b> Domain: input space</a></li>
<li class="chapter" data-level="2.4" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#range-output-space"><i class="fa fa-check"></i><b>2.4</b> Range: output space</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="naked-intro.html"><a href="naked-intro.html"><i class="fa fa-check"></i><b>3</b> Naked modeling functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="naked-intro.html"><a href="naked-intro.html#the-list"><i class="fa fa-check"></i><b>3.1</b> The list</a></li>
<li class="chapter" data-level="3.2" data-path="naked-intro.html"><a href="naked-intro.html#function-shapes"><i class="fa fa-check"></i><b>3.2</b> Function shapes</a></li>
<li class="chapter" data-level="3.3" data-path="naked-intro.html"><a href="naked-intro.html#the-power-law-family"><i class="fa fa-check"></i><b>3.3</b> The power-law family</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fun-describing.html"><a href="fun-describing.html"><i class="fa fa-check"></i><b>4</b> Describing functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="fun-describing.html"><a href="fun-describing.html#computer-commands"><i class="fa fa-check"></i><b>4.1</b> Computer commands</a></li>
<li class="chapter" data-level="4.2" data-path="fun-describing.html"><a href="fun-describing.html#tables-of-inputs-and-outputs"><i class="fa fa-check"></i><b>4.2</b> Tables of inputs and outputs</a></li>
<li class="chapter" data-level="4.3" data-path="fun-describing.html"><a href="fun-describing.html#word-descriptions"><i class="fa fa-check"></i><b>4.3</b> Word descriptions</a></li>
<li class="chapter" data-level="4.4" data-path="fun-describing.html"><a href="fun-describing.html#computer-function-names"><i class="fa fa-check"></i><b>4.4</b> Computer function names</a></li>
<li class="chapter" data-level="4.5" data-path="fun-describing.html"><a href="fun-describing.html#mathematical-notation"><i class="fa fa-check"></i><b>4.5</b> Mathematical notation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fun-notation.html"><a href="fun-notation.html"><i class="fa fa-check"></i><b>5</b> Notation for functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="fun-notation.html"><a href="fun-notation.html#a-notation-for-computing"><i class="fa fa-check"></i><b>5.1</b> A notation for computing</a></li>
<li class="chapter" data-level="5.2" data-path="fun-notation.html"><a href="fun-notation.html#objects-and-actions"><i class="fa fa-check"></i><b>5.2</b> Objects and actions</a></li>
<li class="chapter" data-level="5.3" data-path="fun-notation.html"><a href="fun-notation.html#algorithms"><i class="fa fa-check"></i><b>5.3</b> Formulas and algorithms</a></li>
<li class="chapter" data-level="5.4" data-path="fun-notation.html"><a href="fun-notation.html#algorithms-without-formulas"><i class="fa fa-check"></i><b>5.4</b> Algorithms without formulas</a></li>
<li class="chapter" data-level="5.5" data-path="fun-notation.html"><a href="fun-notation.html#computer-notation"><i class="fa fa-check"></i><b>5.5</b> Computer notation</a></li>
<li class="chapter" data-level="5.6" data-path="fun-notation.html"><a href="fun-notation.html#calcz-naming-conventions"><i class="fa fa-check"></i><b>5.6</b> CalcZ naming conventions</a></li>
<li class="chapter" data-level="5.7" data-path="fun-notation.html"><a href="fun-notation.html#functions-in-r"><i class="fa fa-check"></i><b>5.7</b> Functions in R</a></li>
<li class="chapter" data-level="5.8" data-path="fun-notation.html"><a href="fun-notation.html#foursigns"><i class="fa fa-check"></i><b>5.8</b> <span class="math inline">\(=\)</span>, <span class="math inline">\(\equiv\)</span>, <span class="math inline">\(\rightarrow\)</span>, <code>&lt;-</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html"><i class="fa fa-check"></i><b>6</b> Graphics &amp; function graphs</a>
<ul>
<li class="chapter" data-level="6.1" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#the-graphics-frame"><i class="fa fa-check"></i><b>6.1</b> The graphics frame</a></li>
<li class="chapter" data-level="6.2" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#data-graphics-the-point-plot"><i class="fa fa-check"></i><b>6.2</b> Data graphics: the point plot</a></li>
<li class="chapter" data-level="6.3" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#graphics-layers"><i class="fa fa-check"></i><b>6.3</b> Graphics layers</a></li>
<li class="chapter" data-level="6.4" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#data-and-functions"><i class="fa fa-check"></i><b>6.4</b> Data and functions</a></li>
<li class="chapter" data-level="6.5" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#inputs-to-output-1"><i class="fa fa-check"></i><b>6.5</b> Inputs to output</a></li>
<li class="chapter" data-level="6.6" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#outputs-to-inputs"><i class="fa fa-check"></i><b>6.6</b> Outputs to inputs</a></li>
<li class="chapter" data-level="6.7" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#graphs-of-functions-with-two-inputs"><i class="fa fa-check"></i><b>6.7</b> Graphs of functions with two inputs</a></li>
<li class="chapter" data-level="6.8" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#contour-plots"><i class="fa fa-check"></i><b>6.8</b> Contour plots</a></li>
<li class="chapter" data-level="6.9" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#slice-plots"><i class="fa fa-check"></i><b>6.9</b> Slice plots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="params-intro.html"><a href="params-intro.html"><i class="fa fa-check"></i><b>7</b> Parameters for functions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="params-intro.html"><a href="params-intro.html#parallel-scales"><i class="fa fa-check"></i><b>7.1</b> Parallel scales</a></li>
<li class="chapter" data-level="7.2" data-path="params-intro.html"><a href="params-intro.html#scale-the-output"><i class="fa fa-check"></i><b>7.2</b> Scale the output</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="process-of-modeling.html"><a href="process-of-modeling.html"><i class="fa fa-check"></i><b>8</b> Process of modeling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="process-of-modeling.html"><a href="process-of-modeling.html#variations-from-scaling"><i class="fa fa-check"></i><b>8.1</b> Variations from scaling</a></li>
<li class="chapter" data-level="8.2" data-path="process-of-modeling.html"><a href="process-of-modeling.html#fit-exponential"><i class="fa fa-check"></i><b>8.2</b> Curve fitting an exponential function</a></li>
<li class="chapter" data-level="8.3" data-path="process-of-modeling.html"><a href="process-of-modeling.html#fit-periodic"><i class="fa fa-check"></i><b>8.3</b> Curve fitting a periodic function</a></li>
<li class="chapter" data-level="8.4" data-path="process-of-modeling.html"><a href="process-of-modeling.html#curve-fitting-a-power-law-function"><i class="fa fa-check"></i><b>8.4</b> Curve fitting a power-law function</a></li>
<li class="chapter" data-level="8.5" data-path="process-of-modeling.html"><a href="process-of-modeling.html#hump-and-sigmoid-functions"><i class="fa fa-check"></i><b>8.5</b> Hump and sigmoid functions</a></li>
<li class="chapter" data-level="8.6" data-path="process-of-modeling.html"><a href="process-of-modeling.html#modeling-cycle"><i class="fa fa-check"></i><b>8.6</b> The modeling cycle</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="process-of-modeling.html"><a href="process-of-modeling.html#example-cooling-water"><i class="fa fa-check"></i><b>8.6.1</b> Example: Cooling water</a></li>
<li class="chapter" data-level="8.6.2" data-path="process-of-modeling.html"><a href="process-of-modeling.html#example-the-tides"><i class="fa fa-check"></i><b>8.6.2</b> Example: The tides</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fun-slopes.html"><a href="fun-slopes.html"><i class="fa fa-check"></i><b>9</b> Slope function</a>
<ul>
<li class="chapter" data-level="9.1" data-path="fun-slopes.html"><a href="fun-slopes.html#change-and-slope"><i class="fa fa-check"></i><b>9.1</b> Change and slope</a></li>
<li class="chapter" data-level="9.2" data-path="fun-slopes.html"><a href="fun-slopes.html#continuous-change"><i class="fa fa-check"></i><b>9.2</b> Continuous change</a></li>
<li class="chapter" data-level="9.3" data-path="fun-slopes.html"><a href="fun-slopes.html#slope"><i class="fa fa-check"></i><b>9.3</b> Slope</a></li>
<li class="chapter" data-level="9.4" data-path="fun-slopes.html"><a href="fun-slopes.html#the-fitted-line"><i class="fa fa-check"></i><b>9.4</b> The fitted line</a></li>
<li class="chapter" data-level="9.5" data-path="fun-slopes.html"><a href="fun-slopes.html#average-rate-of-change"><i class="fa fa-check"></i><b>9.5</b> Average rate of change</a></li>
<li class="chapter" data-level="9.6" data-path="fun-slopes.html"><a href="fun-slopes.html#instantaneous-rate-of-change"><i class="fa fa-check"></i><b>9.6</b> Instantaneous rate of change</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="magnitudes.html"><a href="magnitudes.html"><i class="fa fa-check"></i><b>14</b> Magnitudes</a>
<ul>
<li class="chapter" data-level="14.1" data-path="magnitudes.html"><a href="magnitudes.html#counting-digits"><i class="fa fa-check"></i><b>14.1</b> Counting digits</a></li>
<li class="chapter" data-level="14.2" data-path="magnitudes.html"><a href="magnitudes.html#using-digit-to-understand-magnitude"><i class="fa fa-check"></i><b>14.2</b> Using digit() to understand magnitude</a></li>
<li class="chapter" data-level="14.3" data-path="magnitudes.html"><a href="magnitudes.html#quantity-and-magnitude"><i class="fa fa-check"></i><b>14.3</b> Quantity and magnitude</a></li>
<li class="chapter" data-level="14.4" data-path="magnitudes.html"><a href="magnitudes.html#composing-ln"><i class="fa fa-check"></i><b>14.4</b> Composing <span class="math inline">\(\ln()\)</span></a></li>
<li class="chapter" data-level="14.5" data-path="magnitudes.html"><a href="magnitudes.html#magnitude-graphics"><i class="fa fa-check"></i><b>14.5</b> Magnitude graphics</a></li>
<li class="chapter" data-level="14.6" data-path="magnitudes.html"><a href="magnitudes.html#magnitude-scales"><i class="fa fa-check"></i><b>14.6</b> Magnitude scales</a></li>
<li class="chapter" data-level="14.7" data-path="magnitudes.html"><a href="magnitudes.html#fractional-digits"><i class="fa fa-check"></i><b>14.7</b> Fractional digits (optional)</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="dimensions.html"><a href="dimensions.html"><i class="fa fa-check"></i><b>15</b> Dimensions</a>
<ul>
<li class="chapter" data-level="15.1" data-path="dimensions.html"><a href="dimensions.html#mathematics-of-quantity"><i class="fa fa-check"></i><b>15.1</b> Mathematics of quantity</a></li>
<li class="chapter" data-level="15.2" data-path="dimensions.html"><a href="dimensions.html#compound-dimensions"><i class="fa fa-check"></i><b>15.2</b> Compound dimensions</a></li>
<li class="chapter" data-level="15.3" data-path="dimensions.html"><a href="dimensions.html#arithmetic-with-dimensions"><i class="fa fa-check"></i><b>15.3</b> Arithmetic with dimensions</a></li>
<li class="chapter" data-level="15.4" data-path="dimensions.html"><a href="dimensions.html#example-dimensional-analysis"><i class="fa fa-check"></i><b>15.4</b> Example: Dimensional analysis</a></li>
<li class="chapter" data-level="15.5" data-path="dimensions.html"><a href="dimensions.html#conversion-flavors-of-1"><i class="fa fa-check"></i><b>15.5</b> Conversion: Flavors of 1</a></li>
<li class="chapter" data-level="15.6" data-path="dimensions.html"><a href="dimensions.html#dimensions-and-linear-combinations"><i class="fa fa-check"></i><b>15.6</b> Dimensions and linear combinations</a></li>
</ul></li>
<li class="part"><span><b>II Block 2: Differentiation</b></span></li>
<li class="chapter" data-level="" data-path="outline-of-block-2.html"><a href="outline-of-block-2.html"><i class="fa fa-check"></i>Outline of Block 2</a></li>
<li class="chapter" data-level="16" data-path="change-relationships.html"><a href="change-relationships.html"><i class="fa fa-check"></i><b>16</b> Change relationships</a>
<ul>
<li class="chapter" data-level="16.1" data-path="change-relationships.html"><a href="change-relationships.html#slopes-and-motion"><i class="fa fa-check"></i><b>16.1</b> Slopes and motion</a></li>
<li class="chapter" data-level="16.2" data-path="change-relationships.html"><a href="change-relationships.html#differentiation"><i class="fa fa-check"></i><b>16.2</b> Differentiation</a></li>
<li class="chapter" data-level="16.3" data-path="change-relationships.html"><a href="change-relationships.html#notations-for-differentiation"><i class="fa fa-check"></i><b>16.3</b> Notations for differentiation</a></li>
<li class="chapter" data-level="16.4" data-path="change-relationships.html"><a href="change-relationships.html#dimension-of-derivatives"><i class="fa fa-check"></i><b>16.4</b> Dimension of derivatives</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="computing-derivs.html"><a href="computing-derivs.html"><i class="fa fa-check"></i><b>17</b> Computing derivatives</a>
<ul>
<li class="chapter" data-level="17.1" data-path="computing-derivs.html"><a href="computing-derivs.html#a-function-from-a-function"><i class="fa fa-check"></i><b>17.1</b> A function from a function</a></li>
<li class="chapter" data-level="17.2" data-path="computing-derivs.html"><a href="computing-derivs.html#finite-differencing"><i class="fa fa-check"></i><b>17.2</b> Finite differencing</a></li>
<li class="chapter" data-level="17.3" data-path="computing-derivs.html"><a href="computing-derivs.html#the-slope-function-operator"><i class="fa fa-check"></i><b>17.3</b> The slope-function operator</a></li>
<li class="chapter" data-level="17.4" data-path="computing-derivs.html"><a href="computing-derivs.html#symbolic-differentiation"><i class="fa fa-check"></i><b>17.4</b> Symbolic differentiation</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="convexity-and-curvature.html"><a href="convexity-and-curvature.html"><i class="fa fa-check"></i><b>18</b> Convexity and curvature</a>
<ul>
<li class="chapter" data-level="18.1" data-path="convexity-and-curvature.html"><a href="convexity-and-curvature.html#concavity"><i class="fa fa-check"></i><b>18.1</b> Concavity</a></li>
<li class="chapter" data-level="18.2" data-path="convexity-and-curvature.html"><a href="convexity-and-curvature.html#curvature"><i class="fa fa-check"></i><b>18.2</b> Curvature</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="cont-and-smooth.html"><a href="cont-and-smooth.html"><i class="fa fa-check"></i><b>19</b> Continuity and smoothness</a>
<ul>
<li class="chapter" data-level="19.1" data-path="cont-and-smooth.html"><a href="cont-and-smooth.html#continuity"><i class="fa fa-check"></i><b>19.1</b> Continuity</a></li>
<li class="chapter" data-level="19.2" data-path="cont-and-smooth.html"><a href="cont-and-smooth.html#smoothness"><i class="fa fa-check"></i><b>19.2</b> Smoothness</a></li>
<li class="chapter" data-level="19.3" data-path="cont-and-smooth.html"><a href="cont-and-smooth.html#doesnt-exist"><i class="fa fa-check"></i><b>19.3</b> Doesn’t exist?</a></li>
<li class="chapter" data-level="19.4" data-path="cont-and-smooth.html"><a href="cont-and-smooth.html#piecewise-functions-1"><i class="fa fa-check"></i><b>19.4</b> Piecewise functions</a></li>
<li class="chapter" data-level="19.5" data-path="cont-and-smooth.html"><a href="cont-and-smooth.html#continuity-1"><i class="fa fa-check"></i><b>19.5</b> Continuity</a></li>
<li class="chapter" data-level="19.6" data-path="cont-and-smooth.html"><a href="cont-and-smooth.html#differentiability"><i class="fa fa-check"></i><b>19.6</b> Differentiability</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="evanescent-h.html"><a href="evanescent-h.html"><i class="fa fa-check"></i><b>20</b> Evanescent h</a>
<ul>
<li class="chapter" data-level="20.1" data-path="evanescent-h.html"><a href="evanescent-h.html#role-of-h"><i class="fa fa-check"></i><b>20.1</b> Role of h</a></li>
<li class="chapter" data-level="20.2" data-path="evanescent-h.html"><a href="evanescent-h.html#derivatives-of-linear-combinations"><i class="fa fa-check"></i><b>20.2</b> Derivatives of linear combinations</a></li>
<li class="chapter" data-level="20.3" data-path="evanescent-h.html"><a href="evanescent-h.html#derivatives-of-the-basic-modeling-functions"><i class="fa fa-check"></i><b>20.3</b> Derivatives of the basic modeling functions</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="prod-comp-rules.html"><a href="prod-comp-rules.html"><i class="fa fa-check"></i><b>21</b> Differentiation of assembled functions</a>
<ul>
<li class="chapter" data-level="21.1" data-path="prod-comp-rules.html"><a href="prod-comp-rules.html#step-1-identify-f-and-g"><i class="fa fa-check"></i><b>21.1</b> Step 1: Identify f() and g()</a></li>
<li class="chapter" data-level="21.2" data-path="prod-comp-rules.html"><a href="prod-comp-rules.html#step-2-find-f-and-g"><i class="fa fa-check"></i><b>21.2</b> Step 2: Find f’() and g’()</a></li>
<li class="chapter" data-level="21.3" data-path="prod-comp-rules.html"><a href="prod-comp-rules.html#product-rule"><i class="fa fa-check"></i><b>21.3</b> Product rule</a></li>
<li class="chapter" data-level="21.4" data-path="prod-comp-rules.html"><a href="prod-comp-rules.html#composition-chain-rule"><i class="fa fa-check"></i><b>21.4</b> Composition (“chain”) rule</a></li>
<li class="chapter" data-level="21.5" data-path="prod-comp-rules.html"><a href="prod-comp-rules.html#step-3-apply-the-relevant-rule"><i class="fa fa-check"></i><b>21.5</b> Step 3: Apply the relevant rule</a></li>
<li class="chapter" data-level="21.6" data-path="prod-comp-rules.html"><a href="prod-comp-rules.html#exponentials-and-logarithms-optional"><i class="fa fa-check"></i><b>21.6</b> Exponentials and logarithms (optional)</a></li>
<li class="chapter" data-level="21.7" data-path="prod-comp-rules.html"><a href="prod-comp-rules.html#checking-your-work"><i class="fa fa-check"></i><b>21.7</b> Checking your work</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="optim-and-shape.html"><a href="optim-and-shape.html"><i class="fa fa-check"></i><b>22</b> Optimization</a>
<ul>
<li class="chapter" data-level="22.1" data-path="optim-and-shape.html"><a href="optim-and-shape.html#structure-of-the-problem"><i class="fa fa-check"></i><b>22.1</b> Structure of the problem</a></li>
<li class="chapter" data-level="22.2" data-path="optim-and-shape.html"><a href="optim-and-shape.html#interpreting-the-argmax"><i class="fa fa-check"></i><b>22.2</b> Interpreting the argmax</a></li>
<li class="chapter" data-level="22.3" data-path="optim-and-shape.html"><a href="optim-and-shape.html#derivatives-and-optimization"><i class="fa fa-check"></i><b>22.3</b> Derivatives and optimization</a></li>
<li class="chapter" data-level="22.4" data-path="optim-and-shape.html"><a href="optim-and-shape.html#tree-harvesting"><i class="fa fa-check"></i><b>22.4</b> Tree harvesting</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="partial-change.html"><a href="partial-change.html"><i class="fa fa-check"></i><b>23</b> Partial change</a>
<ul>
<li class="chapter" data-level="23.1" data-path="partial-change.html"><a href="partial-change.html#calculus-on-two-inputs"><i class="fa fa-check"></i><b>23.1</b> Calculus on two inputs</a></li>
<li class="chapter" data-level="23.2" data-path="partial-change.html"><a href="partial-change.html#all-other-things-being-equal"><i class="fa fa-check"></i><b>23.2</b> All other things being equal …</a></li>
<li class="chapter" data-level="23.3" data-path="partial-change.html"><a href="partial-change.html#gradient-vector"><i class="fa fa-check"></i><b>23.3</b> Gradient vector</a></li>
<li class="chapter" data-level="23.4" data-path="partial-change.html"><a href="partial-change.html#gradient-vector-1"><i class="fa fa-check"></i><b>23.4</b> Gradient vector</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="local-approximations.html"><a href="local-approximations.html"><i class="fa fa-check"></i><b>24</b> Local approximations</a>
<ul>
<li class="chapter" data-level="24.1" data-path="local-approximations.html"><a href="local-approximations.html#eight-simple-shapes"><i class="fa fa-check"></i><b>24.1</b> Eight simple shapes</a></li>
<li class="chapter" data-level="24.2" data-path="local-approximations.html"><a href="local-approximations.html#low-order-polynomial"><i class="fa fa-check"></i><b>24.2</b> Low-order polynomial</a></li>
<li class="chapter" data-level="24.3" data-path="local-approximations.html"><a href="local-approximations.html#the-low-order-polynomial-with-two-inputs"><i class="fa fa-check"></i><b>24.3</b> The low-order polynomial with two inputs</a></li>
<li class="chapter" data-level="24.4" data-path="local-approximations.html"><a href="local-approximations.html#derivatives-of-polynomials"><i class="fa fa-check"></i><b>24.4</b> Derivatives of polynomials</a></li>
<li class="chapter" data-level="24.5" data-path="local-approximations.html"><a href="local-approximations.html#approximations-around-xstar"><i class="fa fa-check"></i><b>24.5</b> Approximations around <span class="math inline">\(x^\star\)</span></a></li>
<li class="chapter" data-level="24.6" data-path="local-approximations.html"><a href="local-approximations.html#solving-computationally"><i class="fa fa-check"></i><b>24.6</b> Solving computationally</a></li>
<li class="chapter" data-level="24.7" data-path="local-approximations.html"><a href="local-approximations.html#from-an-earlier-draft"><i class="fa fa-check"></i><b>24.7</b> From an earlier draft</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="approximation-around-a-point.html"><a href="approximation-around-a-point.html"><i class="fa fa-check"></i><b>25</b> Approximation around a point</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CalcZ Student Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="process-of-modeling" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Process of modeling</h1>
<p>Seen very abstractly, a mathematical model, as we are using the term, is a set of <strong><em>functions</em></strong> that represent the relationships between inputs and outputs.</p>
<p>At the most simple level, building a model can be a short process:</p>
<ol style="list-style-type: decimal">
<li>Develop an understanding of the relationship you want to model. Often, part of this “understanding” is the pattern seen in data.</li>
<li>Choose a function type—e.g. exponential, sinusoidal, sigmoid—that you think would be a good match to the relationship.</li>
<li>Find parameters that scales your function to be able to accept real-world inputs and generate real-world outputs.</li>
</ol>
<p>It’s important to distinguish between two basic types of model:</p>
<ol style="list-style-type: decimal">
<li><strong><em>Empirical models</em></strong> which are rooted in <strong><em>observation</em></strong> and <strong><em>data</em></strong>.</li>
<li><strong><em>Mechanistic models</em></strong> such as those created by applying fundamental laws of physics, chemistry, and such.</li>
</ol>
<p>We are going to put off mechanistic models for a while, for two reasons. First, the “fundamental laws of physics, chemistry, and such” are often expressed with the concepts and methods of calculus. We are heading there, but at this point you don’t yet know the core concepts and methods of calculus. Second, most students don’t make a careful study of the “fundamental laws of physics, chemistry, and such” until <em>after</em> they have studied calculus. So examples of mechanistic models will be a bit hollow at this point.</p>
<p>The process of constructing a model that is a good match for data is called <strong><em>curve fitting</em></strong>, or, more generally, <strong><em>fitting a model</em></strong>.</p>
<div id="variations-from-scaling" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Variations from scaling</h2>
<p>A good place to start building a model is to pick one of the basic modeling functions. This works surprisingly often. To remind you, here are our seven basic modeling functions:</p>
<ul>
<li>straight-line</li>
<li>exponential</li>
<li>power-law</li>
<li>logarithm</li>
<li>sinusoid</li>
<li>hump</li>
<li>sigmoid</li>
</ul>
<p>It helps in making the selection to have ready to mind the basic shape of each of these function families. To review, revisit Section <a href="naked-intro.html#function-shapes">3.2</a>.</p>
<p>Remember also that, in general, we scale the inputs and scale the output. This means that in choose a model family, we don’t have to worry at first about the numbers on the axes. (Of course, those numbers will be critically important later on in the process!) The scaling does, however, allow us to consider some variations on the shapes of the modeling functions. In particular, the <strong><em>input scaling</em></strong> lets us flip the shape right-for-left. And the <strong><em>output scaling</em></strong> lets us flip the shape top-for-bottom.</p>
<ul>
<li><span class="math inline">\(f(t)\)</span>, basic shape</li>
<li><span class="math inline">\(f(-t)\)</span>, flipped right-for-left</li>
<li><span class="math inline">\(-f(t)\)</span>, flipped top-for-bottom</li>
<li><span class="math inline">\(-f(-t)\)</span>, flipped both top-for-bottom and right-for-left</li>
</ul>
<p>For functions such as the sinusoid, flipping is not much use, since the flipped sinusoid curve is still a sinusoid. Similarly, a right-for-left flipped hump function has the same shape as the original. For the straight-line function, flipping of either sort accomplishes the same thing: changing the sign of the slope.</p>
<p>For the exponential function, the two possible types of flipping—right-for-left and top-for-bottom—produce four different curves, all of which are exponential, shown in Figure <a href="process-of-modeling.html#fig:four-variations">8.1</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:four-variations"></span>
<img src="CalcZ-notes_files/figure-html/four-variations-1.png" alt="Four variations of the exponential functions." width="50%" /><img src="CalcZ-notes_files/figure-html/four-variations-2.png" alt="Four variations of the exponential functions." width="50%" /><img src="CalcZ-notes_files/figure-html/four-variations-3.png" alt="Four variations of the exponential functions." width="50%" /><img src="CalcZ-notes_files/figure-html/four-variations-4.png" alt="Four variations of the exponential functions." width="50%" />
<p class="caption">
Figure 8.1: Four variations of the exponential functions.
</p>
</div>

<div class="exercise">
<span id="exr:unnamed-chunk-51" class="exercise"><strong>Exercise 8.1  (exponential-bases)  </strong></span>
</div>
<details>
<p>These three expressions</p>
<p><span class="math display">\[e^{kt}\ \ \ \ \ 10^{t/d} \  \ \ \ \  2^{t/h}\]</span></p>
<p>produce the same value if <span class="math inline">\(k\)</span>, <span class="math inline">\(d\)</span> and <span class="math inline">\(h\)</span> have corresponding numerical values.</p>
<div class="scaffolding">
<p>The scaffolding has an expression for plotting out <span class="math inline">\(2^{t/h}\)</span> for <span class="math inline">\(-4 \leq t \leq 12\)</span> where <span class="math inline">\(h = 4\)</span>. It also plots out <span class="math inline">\(e^{kt}\)</span> and <span class="math inline">\(10^{t/d}\)</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="process-of-modeling.html#cb31-1" aria-hidden="true" tabindex="-1"></a>fa <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="dv">2</span><span class="sc">^</span>(t<span class="sc">/</span>h) <span class="sc">~</span> t, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb31-2"><a href="process-of-modeling.html#cb31-2" aria-hidden="true" tabindex="-1"></a>fb <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="dv">10</span><span class="sc">^</span>(t<span class="sc">/</span>d) <span class="sc">~</span> t, <span class="at">d =</span> <span class="dv">10</span>)</span>
<span id="cb31-3"><a href="process-of-modeling.html#cb31-3" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">exp</span>(k<span class="sc">*</span>t)  <span class="sc">~</span> t, <span class="at">k =</span> <span class="fl">0.1</span>)</span>
<span id="cb31-4"><a href="process-of-modeling.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="process-of-modeling.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">fa</span>(t) <span class="sc">~</span> t, <span class="fu">domain</span>(<span class="at">t =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">12</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="process-of-modeling.html#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">fb</span>(t) <span class="sc">~</span> t, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="process-of-modeling.html#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">fc</span>(t) <span class="sc">~</span> t, <span class="at">color  =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="process-of-modeling.html#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>))</span></code></pre></div>
</div>
<p>Your task is to modify the values of <code>d</code> and <code>k</code> such that all three curves lie on top of one another. (Leave <code>h</code> at the value 4.) You can find the appropriate values of <code>d</code> and <code>k</code> to accomplish this by any means you like, say, by using the algebra of exponents or by using trial and error. (Trial and error is a perfectly valid strategy regardless of what your high-school math teachers might have said about “guess and check.” The trick is to make each new guess systematically based on your previous ones and observation of how those previous ones performed.)</p>
<p>After you have found values of <code>k</code> and <code>d</code> that are suited to the task …</p>
<p><strong>Essay question tmp-1</strong>: Enter the numerical value of your best estimate of <code>k</code>.</p>
<strong>Essay question tmp-2</strong>: Enter the numerical value of your beat estimate of <code>d</code>.
</details>
</div>
<div id="fit-exponential" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Curve fitting an exponential function</h2>
<p>The exponential function is particularly useful when the quantity we want to model shows <strong><em>constant proportional increase</em></strong>. Many quantities in everyday life are this way. For instance, an increase in salary is typically presented in a format like “a 3% increase.” The population growth of a country is often presented as “percent per year.” Inflation in the price of goods is similarly described in percent per year. Interest on money in a bank savings account is also described as percent per year. But if you have the bad fortune to owe money to a loan shark, the proportional increase might be described as “percent per month” or “percent per week.”</p>
<p>When you know the “percent increase per time” of a quantity whose initial value is <span class="math inline">\(A\)</span>, the exponential function is easy to write down: <span class="math display">\[f(t) = A (1+r)^t\]</span>
The number <span class="math inline">\(r\)</span> is often called the <strong><em>interest rate</em></strong> or <strong><em>discount rate</em></strong> and is given in <strong>percent</strong>.</p>
<div class="takenote">
<p>Regrettably, it’s extremely easy amd common to forget the rules for addition with percent. If <span class="math inline">\(r = 5\%\)</span>, then <span class="math inline">\((1+r) = 1.05\)</span>, not 6. Always keep in mind that <span class="math inline">\(5\%\)</span> means <span class="math inline">\(\frac{5}{100}\)</span>.</p>
<p>Another source of error stems from the tradition in mathematics of using the number <span class="math inline">\(e=2.718282\)</span> as the “natural” base of the exponential function, whereas in <span class="math inline">\(f(t) = A (1+r)^t\)</span> the base is <span class="math inline">\(1+r\)</span>.</p>
<p>You can translate an exponential <span class="math inline">\(b^t\)</span> in any base <span class="math inline">\(b\)</span> to the “natural” base. This is just a matter of calculating the appropriate parameter <span class="math inline">\(k\)</span> such that <span class="math inline">\(e^k = b\)</span>. Using logarithms, <span class="math display">\[e^k = b\ \ \implies \ \  k=\ln(b)\]</span> For instance, if
<span class="math inline">\(r=5\%\)</span> per year, we’ll have <span class="math inline">\(k = \ln(1+r) = \ln(1.05) = 0.488\)</span> per year.</p>
<p>Almost everybody is happier doing arithmetic with numbers like 2 and 10 rather than <span class="math inline">\(e=2.718282\)</span>. For this reason, you may see formulations of the exponential function as <span class="math inline">\(g(t) \equiv 2^{a t}\)</span> or <span class="math inline">\(h(t) \equiv 10^{c t}\)</span>. Remember that <span class="math inline">\(2^{a t}\)</span> and <span class="math inline">\(e^{at}\)</span>, although both exponential functions, are quantitatively different. If you want to write <span class="math inline">\(2^{at}\)</span> using the “natural” base, it will be <span class="math inline">\(e^{\ln(2) a\, t }\)</span>. Similarly, <span class="math inline">\(10^{ct} = e^{\ln(10) c\, t}\)</span>.</p>
</div>
<p>Exponential functions also describe <strong><em>decrease</em></strong> or <strong><em>decay</em></strong>. Just replace <span class="math inline">\(t\)</span> with <span class="math inline">\(-t\)</span>. That is, a movie of a decreasing quantity is just the movie of an increasing quantity played backwards in time!</p>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-intro-1">8.2</a> shows some data collected by Prof. Stan Wagon to support his making a detailed mechanistic model of an everyday phenomenon: <a href="https://www.researchgate.net/profile/Gianluca_Argentini/post/Is_analogy_reasoning_between_heat_transfert_and_electriocity_allows_to_apply_the_electricity_laws_about_resistance_to_thermal_resistances/attachment/59d6573379197b80779ada64/AS%3A533325451403264%401504166104259/download/Stan+WAGON+How+quickly+does+water+cool.pdf">The cooling of a mug of hot beverage to room temperature</a>. The mug started at room temperature, which was measured at 26 degrees C. At time 0 he poured in boiling water from a kettle and measured the temperature of the water over the next few hours.</p>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-intro-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-intro-1-1.png" alt="Stan's data" width="90%" />
<p class="caption">
Figure 8.2: Stan’s data
</p>
</div>
<p>Our task is to translate this data into the form of a function that takes time as input and returns temperature as output. Such a model would be useful for, say, filling in the gaps of the data. For instance, we might want to find the temperature of the water immediately after being poured from the kettle into the mug.</p>
<p>Looking at the data, one sees that the temperature decreases along a curve: cooling fast at first and then more slowly. This is the pattern of the flipped right-for-left exponential. (Figure <a href="process-of-modeling.html#fig:four-variations">8.1</a>(B)) We can imagine then that an exponential, <span class="math inline">\(A e^{kt} + C\)</span> will be a suitable model form for the cooling water.</p>
<p>What remains is to find the parameters <span class="math inline">\(A\)</span>, <span class="math inline">\(k\)</span>, and <span class="math inline">\(C\)</span>. Here is a general process for curve-fitting an exponential. Later, we’ll apply this process specifically to the water-cooling situation.</p>
<p><strong>General process for curve-fitting an exponential</strong></p>
<p><strong>Step 0</strong>: Check that the data show an exponential pattern in one of its variations, namely a smooth increase or decrease and leveling out beyond some value of <span class="math inline">\(t\)</span>. If this isn’t true, reconsider whether you should be using an exponential function in the first place.</p>
<p><strong>Step 1</strong> Do the data show exponential growth or exponential decay? If it’s exponential growth, then the flat region in Step 0 will be to the left and <span class="math inline">\(k\)</span> will be positive. If exponential decay, the flat region will be to the right and <span class="math inline">\(k\)</span> will be negative.</p>
<p>Notice that the question of “growth or decay” depends only on the sign of the parameter <span class="math inline">\(k\)</span>. You can have an exponentially decaying process that’s increasing. Consider, for instance, the speed of a car as it merges onto a highway from a slow speed on the entrance ramp. The car’s velocity is increasing, but as you approach highway speed the rate of increase gets smaller. That’s exponential decay.</p>
<p><strong>Step 2</strong> Where is the baseline? We’re going to put aside <span class="math inline">\(k\)</span> for the moment and find the value of the output that is being approached asymptotically, that is, the height of the level zone of the data. This height is the coefficient <span class="math inline">\(A\)</span> in the linear combination.</p>
<p><strong>Step 3</strong> Once you know the baseline, you’re set to find a numerical value for the parameter <span class="math inline">\(k\)</span>.</p>
<ol style="list-style-type: lower-roman">
<li>Pick a point in the data far from the baseline. Call the input <span class="math inline">\(t_1\)</span>.</li>
<li>Scan forward or backward in time to find a point in the data that’s vertically half way from the original point toward the baseline. Call the input at that point <span class="math inline">\(t_{1/2}\)</span>. The difference between these, <span class="math inline">\(t_1 - t_{1/2}\)</span> is called the <strong><em>half-life</em></strong> or <strong><em>halving-time</em></strong> if it’s negative and the <strong><em>doubling time</em></strong> if it’s positive.</li>
<li>The parameter <span class="math inline">\(k\)</span> is <span class="math inline">\(0.693 / (t_1 - t_{1/2})\)</span>. Double check the sign of <span class="math inline">\(k\)</span> to make sure it’s consistent with what you saw in Step 1. (Incidently, <span class="math inline">\(0.693 = \ln(2)\)</span>. The 2 is the same as the 2 in doubling or halving.)</li>
</ol>
<p><strong>Step 4</strong> Now that you have numerical values for the baseline <span class="math inline">\(A\)</span> and the parameter <span class="math inline">\(k\)</span>, calculating the value of <span class="math inline">\(B\)</span> is straightforward.<br />
i. Pick a <span class="math inline">\(t_0\)</span> that’s reasonably well represented in your data. Find the vertical coordinate represented by the data near that <span class="math inline">\(t_0\)</span>. Call that <span class="math inline">\({\cal D}\)</span>.
ii. Solve with respect to <span class="math inline">\(B\)</span> the equation <span class="math inline">\(A + B e^{k t_0} = {\cal D}\)</span>. Things are particularly easy if you can use <span class="math inline">\(t_0 = 0\)</span>. Then you just straight off calculate <span class="math inline">\(B = {\cal D} - A\)</span>.</p>
<p><strong>Step 5</strong> Plot the function <span class="math inline">\(A + B e^{k t}\)</span> using the values for <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(t\)</span> that you just found. If you are not satisfied, tweak the parameters a bit until you are.</p>
<p><strong>Exponential curve fitting applied to the water-cooling data</strong></p>
<p>Let’s illustrate the general process on the water-cooling data, redrawn in Figure <a href="process-of-modeling.html#fig:Fun-4-a-2-1">8.3</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-2-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-2-1-1.png" alt="The cooling-water data, repeated here for convenience." width="90%" />
<p class="caption">
Figure 8.3: The cooling-water data, repeated here for convenience.
</p>
</div>
<p>Step 0: The data indicate a smooth curve. As <span class="math inline">\(t\)</span> gets large, the curve approaches a constant. So an exponential model is reasonable.</p>
<p>Step 1: The flat zone of the data is to the right. So we’ve got exponential decay and <span class="math inline">\(k &lt; 0\)</span>.</p>
<p>Step 2: The curve looks like it’s leveling out at a temperature of about 25 degrees C for large <span class="math inline">\(t\)</span>. So <span class="math inline">\(A \approx 25^{\circ} \text{C}\)</span>.</p>
<p>Step 3:</p>
<ol style="list-style-type: lower-roman">
<li>The point furthest from the baseline is located at <span class="math inline">\(t_1 = 15 \text{sec}\)</span> with a value <span class="math inline">\({\cal D} \approx 80^\circ\text{C}\)</span>.</li>
<li>This if <span class="math inline">\(55^\circ\text{C}\)</span> from the baseline. We want to find the value of <span class="math inline">\(t_1\)</span> where the temperature will be half way from 80 to the baseline. That’s a temperature of about <span class="math inline">\(80 - 55/2 = 53.5\)</span>. Scanning over to the right, the function that I can imagine going through the data crossed <span class="math inline">\(53^\circ\)</span> at about <span class="math inline">\(t_{1/2} = 40\)</span>. Thus, the half-life is estimated at 25s.</li>
<li>The parameter <span class="math inline">\(k\)</span> is therefore $k<span class="math inline">\(0.693 / \mbox{half-life}) = - 0.63 / 25 = -0.0277\)</span>. Since we identified in Step 1 that exponential decay is involved, we expect <span class="math inline">\(k\)</span> to be negative. It is.</li>
</ol>
<p>Step 4.</p>
<ol style="list-style-type: lower-roman">
<li>We know <span class="math inline">\(A \approx 25\)</span> and <span class="math inline">\(k \approx -0.0277\)</span>. We also now that for <span class="math inline">\(t=15\)</span> the function output is about <span class="math inline">\({\cal D} = 80^\circ\)</span>.</li>
<li>This means <span class="math inline">\(25^\circ + B e^{- 0.0277 \times 15} \approx 80^\circ = 25 + 0.66 B\)</span>. Solving for <span class="math inline">\(B\)</span> gives <span class="math inline">\(B = (80 - 25)/0.66 = 83.3\)</span></li>
</ol>
<p>Step 5. Graph the function over the data.</p>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-2-2"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-2-2-1.png" alt="An exponential function that roughly aligns with the data." width="90%" />
<p class="caption">
Figure 8.4: An exponential function that roughly aligns with the data.
</p>
</div>

<div class="exercise">
<span id="exr:unnamed-chunk-52" class="exercise"><strong>Exercise 8.2  (chicken-choose-vase)  </strong></span>
</div>
<details>
<p>The Bargain Basement store wants to sell its goods quickly. Consequently, they reduce each product’s price <span class="math inline">\(P\)</span> by 5% per day.</p>
<p><strong>Question A</strong> If a jacket costs $80 today, how much will it cost in <span class="math inline">\(t\)</span> days?</p>
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(P = 80 - 5t\)</span><span class="mcanswer"> ☹︎ Remember, 5 percent is exactly the same as 0.05 </span><br />
</li>
<li><span class="math inline">\(P = 80 - 4t\)</span><span class="mcanswer"> ☹︎ Remember, 4 percent is exactly the same as 0.04 </span><br />
</li>
<li><span class="math inline">\(P = 80 - 0.05t\)</span><span class="mcanswer"> ☹︎ This would be a decrease in price by 5 cents every day. </span><br />
</li>
<li><span class="math inline">\(P = 80 (0.05)^t\)</span><span class="mcanswer"> ☹︎ Each day’s price would be only 5% that of the previous day’s price. </span><br />
</li>
<li><span class="math inline">\(P = 80 (0.95)^t\)</span><span class="mcanswer"> ✓ </span></li>
</ol>
<p>You’ll need to open a sandbox for the next question.</p>
<div class="scaffolding">
<p>You’re on your own here! Remember, to raise a number to a power, you can use an expression like `0.95^7$.</p>
</div>
<p><strong>Question B</strong> You decided that you like the $80 jacket, but you have a budget of only $60. How long should you wait before coming back to the Bargain Basement store.?</p>
<p>    3 days<span class="mcanswer"> ☹︎ On day 3 the price will be <span class="math inline">\(0.95 imes 0.95 imes 0.95 imes 80\)</span>. That’s above your budget. </span>       4 days<span class="mcanswer"> ☹︎ On day 4 the price will be <span class="math inline">\(80 \times 0.95^4\)</span>= $65.16. Too much! </span>       5 days<span class="mcanswer"> ☹︎ On day 5 the price will be <span class="math inline">\(80 \times 0.95^5\)</span>= $61.90. Close, but still higher than your budget. </span>       6 days<span class="mcanswer"> ✓ </span></p>
</details>

<div class="exercise">
<span id="exr:unnamed-chunk-53" class="exercise"><strong>Exercise 8.3  (cow-type-kayak-new)  </strong></span>
</div>
<details>
<p>The Wikipedia entry on “Common Misconceptions” used to contain this item:</p>
<blockquote>
<p><em>Some cooks believe that food items cooked with wine or liquor will be non-alcoholic, because alcohol’s low boiling point causes it to evaporate quickly when heated. However, a study found that some of the alcohol remains: 25% after 1 hour of baking or simmering, and 10% after 2 hours.</em></p>
</blockquote>
<p>The modeler’s go-to function type for events like the evaporation of alcohol is exponential: The amount of alcohol that evaporates would, under constant conditions (e.g. an oven’s heat), be proportional to the amount of alcohol that hasn’t yet evaporated.</p>
<p><strong>Question A</strong> A) Assume that 25% of the alcohol remains after 1 hour? If the process were exponential, how much would remain after 2 hours?</p>
<p>    10%<span class="mcanswer"> ☹︎ That’s what the study is reported to have found, but that’s not consistent with an exponential process that decays to 25% after one hour </span>       25%<span class="mcanswer"> ☹︎ Exponentials decay to zero eventually, so don’t expect things to stay still after one hour. </span>       25% of 25%<span class="mcanswer"> ✓ We know that 75% is eliminated over 1 hour, leaving 25%. The continuing exponential process will, over the next hour eliminate 75% of the amount at the start of that hour. So after hour 2 we’ll have 25% of the amount we had at hour 1, which was 25% of the original amount. </span>       75%<span class="mcanswer"> ☹︎ That’s how much was eliminated in the first hour, not how much remains after 2 hours. </span>       75% of 75%<span class="mcanswer"> ☹︎ In an exponential process, at any moment the rate of decay (e.g. 75% per hour) is a constant proportion of the amount that is still there. After one hour, there is 25% of the alcohol remaining. That will decay at a rate of 75% per hour. Over the next hour, we’ll lose 75% of the original 25%, giving us 25% of the original amount. </span></p>
<p><strong>Question B</strong> B) What is the half-life of an exponential process that decays to 25% after one hour?</p>
<ol style="list-style-type: lower-roman">
<li>15 minutes<span class="mcanswer"> ☹︎ This provides time for four halvings in one hour, which would leave <span class="math inline">\(\frac{1}{2} \times \frac{1}{2} \times \frac{1}{2} \times \frac{1}{2} = 1/16\)</span> of the original not 1/4. </span><br />
</li>
<li>30 minutes<span class="mcanswer"> ✓ This gives time for two halvings in one hour, bringing us to 25% as observed. </span><br />
</li>
<li>45 minutes<span class="mcanswer"> ☹︎ Two halvings bring us down to 25%. At this rate, it would take 90 minutes to get down to 25%, not 60 minutes as observed. </span><br />
</li>
<li>none of the above<span class="mcanswer"> ☹︎ </span></li>
</ol>
<p>Let’s change pace and think about the “10% after 2 hours” observation. First, recall that the amount left after <span class="math inline">\(n\)</span> halvings is
<span class="math inline">\(\mbox{amount_left}(n) \equiv \frac{1}{2}^n\)</span>
This is an exponential function with base 1/2.</p>
<p>You’re going to carry out a <strong><em>guess-and-check</em></strong> procedure to find a zero of the function <span class="math inline">\(\text{amount_left}(n) - 0.10\)</span> that is, you’ll find what <span class="math inline">\(n\)</span> will generate the stated output value (e.g. 10%).
Open a sandbox and copy over the scaffolding, which include the definition of the <code>amount_left()</code> function. and a “guess” for the input. Change the guess until you get the output 10%.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="process-of-modeling.html#cb32-1" aria-hidden="true" tabindex="-1"></a>amount_left <span class="ot">&lt;-</span> <span class="fu">makeFun</span>((<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>n <span class="sc">~</span> n)</span>
<span id="cb32-2"><a href="process-of-modeling.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">amount_left</span>(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<p><strong>Question C</strong> C) Use <code>amount_left()</code> to figure out how many halvings it takes to bring something down to 10% of the original amount.</p>
<p>    2.58<span class="mcanswer"> ☹︎ </span>       3.32<span class="mcanswer"> ✓ </span>       3.62<span class="mcanswer"> ☹︎ </span>       3.94<span class="mcanswer"> ☹︎ </span>       4.12<span class="mcanswer"> ☹︎ </span></p>
<p>Another way to find the input <span class="math inline">\(n\)</span> that generates an output of 10% is to construct the <strong><em>inverse function</em></strong> to <span class="math inline">\(\text{amount_left}()\)</span>.</p>
<p>The computer already provides you with inverse functions for <span class="math inline">\(2^n\)</span> and <span class="math inline">\(e^n\)</span> and <span class="math inline">\(10^n\)</span>. Their names are <code>log2()</code>, <code>log()</code>, and <code>log10()</code> repectively. Using <code>log2()</code>, write a function named <code>log_half()</code> that gives the inverse function to <span class="math inline">\((1/2)^n\)</span>. Remember, the input to the inverse function corresponds to 10%; the output to the <span class="math inline">\(n\)</span>.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="process-of-modeling.html#cb34-1" aria-hidden="true" tabindex="-1"></a>log_half <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( <span class="fu">log2</span>(...your stuff here ...) <span class="sc">~</span> x)</span></code></pre></div>
</div>
<p><strong>Question D</strong> The answer you got in part C) is the <strong>number</strong> of halvings needed to reach 10%. If this number occurs in 2 hours (that is, 120 minutes), what is the half life stated in minutes.</p>
<p>    30<span class="mcanswer"> ☹︎ </span>       35<span class="mcanswer"> ☹︎ </span>       36<span class="mcanswer"> ✓ </span>       38<span class="mcanswer"> ☹︎ </span>       42<span class="mcanswer"> ☹︎ </span>       47<span class="mcanswer"> ☹︎ </span></p>
<p>Suppose you compromise between the half-life needed to reach 25% after one hour and the half-life needed to reach 10% after two hours. Use, say, 33 minutes as the compromise half life. Using the sandbox below, calculate how much would be left after 1 hour for this compromise half life, and how much left after 2 hours.</p>
<p><strong>Question E</strong> How much is left after 1 hour and after 2 hours when the half life is 33 minutes?</p>
<ol style="list-style-type: lower-roman">
<li>28% and 8%<span class="mcanswer"> ✓ </span><br />
</li>
<li>31% and 4%<span class="mcanswer"> ☹︎ </span><br />
</li>
<li>30% and 9%<span class="mcanswer"> ☹︎ </span><br />
</li>
<li>27% and 9%<span class="mcanswer"> ☹︎ </span></li>
</ol>
</details>

<div class="exercise">
<span id="exr:unnamed-chunk-54" class="exercise"><strong>Exercise 8.4  (maple-hit-saucer)  </strong></span>
</div>
<details>
<p>You have likely heard the phrase “exponential growth” used to describe the COVID-19 pandemic. Let’s explore this idea using actual data.</p>
<p>The <a href="https://covid19datahub.io/">COVID-19 Data Hub</a> is a collaborative effort of universities, government agencies, and NGOs to provide up-to-date information about the pandemic. We’re going to use the data about the US at the whole-country level. (There’s also data at state and county levels.)</p>
<p>Perhaps the simplest display is to show the number of cumulative cases (the <code>confirmed</code> variable) and deaths as a function of time. You can see the documentation for the dataset at the <a href="https://covid19datahub.io/">COVID-19 Data Hub</a></p>
<p>Open a sandbox and make the plot.</p>
<div class="scaffolding">
<p>We’re going to plot confirmed cases in blue and deaths in red.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="process-of-modeling.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(confirmed <span class="sc">~</span> date, <span class="at">data =</span> Covid_US, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="process-of-modeling.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_point</span>(deaths <span class="sc">~</span> date, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-240-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<p><strong>Question A</strong> As of mid July, about how many confirmed cases were there? (Note that the labeled tick marks refer to the beginning of the month, so the point labeled <code>Feb</code> is February 1.)</p>
<ol style="list-style-type: lower-roman">
<li>about 300,000<span class="mcanswer"> ☹︎ The number 1e6 means 1,000,000, that is, six zeros following the one. </span><br />
</li>
<li>about 350,000<span class="mcanswer"> ☹︎ The number 1e6 means 1,000,000, that is, six zeros following the one. </span><br />
</li>
<li>about 400,000<span class="mcanswer"> ☹︎ The number 1e6 means 1,000,000, that is, six zeros following the one. </span><br />
</li>
<li>about 3,000,000<span class="mcanswer"> ☹︎ Mid July is the tick mark <em>after</em> the one labelled <code>Jul</code>. </span><br />
</li>
<li>about 3,500,000<span class="mcanswer"> ✓ </span><br />
</li>
<li>about 4,000,000<span class="mcanswer"> ☹︎ Mid July is the tick mark <em>after</em> the one labelled <code>Jul</code>. </span></li>
</ol>
<p>We’re going to do something to make the graph more informative. (At least, more informative if you understand about logarithms and exponentials!)</p>
<p>Here’s the same graphic as above, but taking the <em>logarithm</em> of the number of cases (that is, <code>confirmed</code>) and of the number of deaths. Since we’re taking the logarithm of only the y-variable, this is called a “semi-log” plot.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="process-of-modeling.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(<span class="fu">log</span>(confirmed) <span class="sc">~</span> date, <span class="at">data =</span> Covid_US, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="process-of-modeling.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_point</span>(<span class="fu">log</span>(deaths) <span class="sc">~</span> date, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-241-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<p>Up through the beginning of March in the US, it is thought that most US cases were in people travelling into the US from hot spots such as China and Italy and the US, as opposed to contagion between people within the US. (Such contagion is called “community spread.”) So let’s focus on the data from the start of March onward.</p>
<p>Exponential growth appears as a straight-line pattern on a semi-log plot. Obviously, the overall pattern of the curves is not a straight line. The explanation for this is that the exponential growth rate changes over time, perhaps due to public health measures (like business closing, masks, etc.)</p>
<p>The first (official) US death from Covid-19 was recorded was recorded on Feb. 29, 2020. Five more deaths occurred two days later, bringing the cumulative number to 6.</p>
<p><strong>Question B</strong> The red data points for Feb 29/March 1 show up at zero on the vertical scale. The red data point for March 2 is at around 2 on the vertical scale. Is this consistent with the facts stated above?</p>
<ol style="list-style-type: lower-roman">
<li>No. The data contradict the facts.<span class="mcanswer"> ☹︎ Think about what it means to be 0 on the vertical scale. </span><br />
</li>
<li>Yes. The vertical scale is in log units, so 0 corresponds to 1 death, since <span class="math inline">\(\ln 1 = 0\)</span>.<span class="mcanswer"> ✓ </span><br />
</li>
<li>No. The vertical scale doesn’t mean anything.<span class="mcanswer"> ☹︎ You can see from the plotting command what the quantity on the vertical axis is: <code>log(confirmed)</code> for the blue dots and <code>log(deaths)</code> for the red. </span></li>
</ol>
<p>One of the purposes of making a semi-log plot is to enable you to compare very large numbers with very small numbers on the same graph. For instance, in the semi-log plot, you can easily see when the first death occurred, a fact that is invisible in the plot of the raw counts (the first plot in this exercise).</p>
<p>Another feature of semi-log plots is that they preserve proportionality. Look at the plot of raw counts and note that the curve for the number of deaths is much shallower than the curve for the number of (confirmed) cases. Yet on the semi-log plot, the two curves are practically parallel.</p>
<p>On a semi-log plot, the arithmetic difference between the two curves tells you what the proportion is between those curves. The parallel curves mean that the proportion is practically constant.
Calculate what the proportion between deaths and cases was in the month of May. Here’s a mathematical hint: <span class="math inline">\(\ln \frac{a}{b} == \ln a - \ln b\)</span>. We are interested in <span class="math inline">\(\frac{a}{b}\)</span>.</p>
<p><strong>Question C</strong> What is the proportion of deaths to cases during the month of May?</p>
<ol style="list-style-type: lower-roman">
<li>about 0.2%<span class="mcanswer"> ☹︎ Remember, it’s the natural logarithm that’s being plotted, so the inverse function is <code>exp()</code>. </span><br />
</li>
<li>about 1%<span class="mcanswer"> ☹︎ This would correspond to a (vertical) difference between the curves of about 4.6 log units. Is it really that big? </span><br />
</li>
<li>about 2%<span class="mcanswer"> ☹︎ This would correspond to a (vertical) difference between the curves of about 4 log units. Is it really that big? </span><br />
</li>
<li>about 6%<span class="mcanswer"> ✓ Good. You calculated <code>exp(log(deaths) - log(cases))</code> which gives an answer around 0.06, or 6%. </span><br />
</li>
<li>about 25%<span class="mcanswer"> ☹︎ I’m not really sure what could lead you to this answer. You’re making a mistake that I didn’t anticipate. </span><br />
</li>
<li>more than 50%<span class="mcanswer"> ☹︎ It’s true that in May log(deaths) is about 12, and log(cases) is about 14, and 12/14 is indeed greater than 50%. But, on a log scale, the proportion relates to the difference between logs, not the ratio. </span></li>
</ol>
<p>In many applications, people use semi-log plots to see whether a pattern is exponential or to compare very small and very large numbers. Often, people find it easier if the vertical scale is written in the original units rather than the log units. To accomplish both, the vertical scale can be ruled with raw units spaced logarithmically, like this:</p>
<div class="scaffolding">
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="process-of-modeling.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(confirmed <span class="sc">~</span> date, <span class="at">data =</span> Covid_US, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="process-of-modeling.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_point</span>(deaths <span class="sc">~</span> date, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="process-of-modeling.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_refine</span>(<span class="fu">scale_y_log10</span>())</span></code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis

## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-242-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<p>The <strong>labels</strong> on the vertical axis show the raw numbers, while the <strong>position</strong> shows the logarithm of those numbers.</p>
<p>The next question has to do with the meaning of the interval between grid lines on the vertical axis. Note that on the <em>horizontal</em> axis, the spacing between adjacent grid lines is half a month.</p>
<p><strong>Question D</strong> What is the numerical spacing (in terms of raw counts) between adjacent grid lines on the vertical axis?</p>
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(10^1\)</span><span class="mcanswer"> ☹︎ If this were true, moving up from the lowest label (<code>1e+01</code>, that is, 10) the next grid line would be at 20, then 30, then 40. </span><br />
</li>
<li><span class="math inline">\(10^2\)</span><span class="mcanswer"> ☹︎ If this were true, moving up from the lowest label (<code>1e+01</code>) the next grid line would be at 110, then 210, then 310. </span><br />
</li>
<li>A factor of 10.<span class="mcanswer"> ✓ Right. Every time you move up by one grid line, the raw number increases ten-fold, so 10, 100, 1000, 10,000, and so on. The phrase <code>a factor of 10</code> means to multiply by 10, not to add 10. </span><br />
</li>
<li>A factor of 100.<span class="mcanswer"> ☹︎ You’re thinking along the right lines, but this is the difference between every second grid line, not adjacent grid lines. </span></li>
</ol>
</details>
</div>
<div id="fit-periodic" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Curve fitting a periodic function</h2>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-1">8.5</a> shows the tide level in <a href="https://www.google.com/maps/place/Providence,+RI/@41.8071,-71.4012,14z/data=!4m5!3m4!1s0x89e444e0437e735d:0x69df7c4d48b3b627!8m2!3d41.8071!4d-71.4012">Providence, Rhode Island</a>, starting at midnight on April 1, 2020 and recorded every minute for four and a half days. (These data were collected by the US National Oceanic and Atmospheric Administration. <a href="https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=20200401%2010:00&amp;end_date=20200405%201:59&amp;station=8454000&amp;product=one_minute_water_level&amp;datum=mllw&amp;units=metric&amp;time_zone=gmt&amp;application=web_services&amp;format=csv">Link</a>)</p>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-3-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-1-1.png" alt="About four days of tide-level data from Providence, Rhode Island" width="90%" />
<p class="caption">
Figure 8.5: About four days of tide-level data from Providence, Rhode Island
</p>
</div>
<p>It’s not too hard to see what’s going on. The tide rises and falls about every 12 hours. The difference between high tide and low tide is a little more than one meter. The tide gauge is calibrated so that a typical reading is 1 meter, although we don’t know what that is respect to. (Certainly not sea level, since then the typical reading would be around zero.)</p>
<p>This simple description tells almost everything needed to construct an A/B model of the tide level using a sinusoid, that is, a function of the form <span class="math display">\[A + B \sin(2\pi t/P)\]</span> The procedure is straightforward:</p>
<p><strong>Step 0</strong>: Determine whether a sinusoid model is appropriate. As you know, sinusoids oscillate up and down repeatedly with a steady <strong><em>period</em></strong>. That certainly seems the case here. But sinusoids are also steady in the <strong><em>peak</em></strong> and <strong><em>trough</em></strong> values for each cycle. That’s only approximately true in the Providence data. Models inevitably involve approximation. We’ll have to keep an eye on whether the <strong><em>fixed amplitude</em></strong> feature of sinusoids</p>
<p><strong>Step 1</strong>: Choose a sensible value to represent the low point repeatedly reached. 0.5 m seems appropriate here, but obviously the exact position of the trough of each cycle varies over the 4.5 day duration of the data. Similarly, the peak is near 1.6 m. Parameter <span class="math inline">\(A\)</span> is the mean of the peak and trough values: <span class="math inline">\(\frac{1.6 + 0.5}{2} = 1.05\)</span> m here. Parameter <span class="math inline">\(B\)</span> is half the difference between the peak and trough values: <span class="math inline">\(\frac{1.6 - 0.5}{2} = 0.55\)</span>. Parameter <span class="math inline">\(A\)</span> is called the <strong><em>baseline</em></strong> of the sinusoid. Paramter <span class="math inline">\(B\)</span> is the <strong><em>amplitude</em></strong>. (Note that by convention, the amplitude is always <em>half</em> the high-to-low range of the sinusoid.)</p>
<p><strong>Step 2</strong>: Estimate the period <span class="math inline">\(P\)</span> of the sinusoid. This can be done with a ruler: the horizontal duration of a complete cycle. I like to use the time between peaks, but the time between troughs would work just as well. Another good choice is the time between positive sloping crossings of the baseline. (But be careful. The time between <em>successive</em> baseline crossings, one positive sloping and the other negative, give just <em>half</em> the period.)</p>
<p>On the scale of the above plot, it’s hard to read off the time of the first peak. So, zoom in until it becomes more obvious.</p>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-3-2"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-2-1.png" alt="Zooming in on the start of the data (left) and on the last part of the data (right)." width="50%" /><img src="CalcZ-notes_files/figure-html/Fun-4-a-3-2-2.png" alt="Zooming in on the start of the data (left) and on the last part of the data (right)." width="50%" />
<p class="caption">
Figure 8.6: Zooming in on the start of the data (left) and on the last part of the data (right).
</p>
</div>
<p>The left panel in Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-2">8.6</a> shows about 24 hours at the start of the record. The first peak is at about 7 hours, the second at about 18 hours. That indicates that the period is 18 - 7 = 11 hours.</p>
<p><strong>Step 3</strong> Plot out the model over the data. Replacing the symbols <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(P\)</span> with our estimates, the model is</p>
<p><span class="math display">\[\require{color}
{\color{green}\mbox{tide}(t) \equiv 1.05 + 0.55 \sin(2\pi t/11)}\]</span></p>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-3">8.7</a> shows this model in <span class="math inline">\(\color{green}\mbox{green}\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-3-3"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-3-1.png" alt="The sinusoid fails to align with the timing of peaks and troughs." width="50%" /><img src="CalcZ-notes_files/figure-html/Fun-4-a-3-3-2.png" alt="The sinusoid fails to align with the timing of peaks and troughs." width="50%" />
<p class="caption">
Figure 8.7: The sinusoid fails to align with the timing of peaks and troughs.
</p>
</div>

<div class="exercise">
<span id="exr:unnamed-chunk-55" class="exercise"><strong>Exercise 8.5  (lamb-talk-gloves)  </strong></span>
</div>
<details>
<p>A person breathes in and out every three seconds. The volume <span class="math inline">\(V\)</span> of air in the person’s lungs varies between a minimum of <span class="math inline">\(2\)</span> liters and a maximum of <span class="math inline">\(4\)</span> liters. Assume time <span class="math inline">\(t\)</span> is measured in seconds.</p>
<p>Remember that a full cycle of the sine wave <span class="math inline">\(\sin(x)\)</span> involves <span class="math inline">\(x\)</span> going from its starting value to that value <strong>plus</strong> <span class="math inline">\(2 \pi\)</span>.</p>
<p><strong>Question A</strong> Which of the following is the most appropriate of these models for <span class="math inline">\(V(t)\)</span>?</p>
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(V(t) \equiv 2 + 2 \sin \left( \frac{\pi}{3} t \right)\)</span><span class="mcanswer"> ☹︎ This varies between a minimum of 0 and a maximum of 2. </span><br />
</li>
<li><span class="math inline">\(V(t) \equiv 3 + \sin \left( \frac{2\pi}{3} t \right)\)</span><span class="mcanswer"> ✓ Good. In this class, we generally write the sine function like <span class="math inline">\(\sin(2 \pi t/P)\)</span> which means that the overall argument to the sine function will go from 0 to <span class="math inline">\(2 \pi\)</span> when <span class="math inline">\(t\)</span> goes from 0 to <span class="math inline">\(P\)</span>. </span><br />
</li>
<li><span class="math inline">\(V(t) \equiv 2 + 2 \sin \left( \frac{2\pi}{3} t \right)\)</span><span class="mcanswer"> ☹︎ This varies between a minimum of 0 and a maximum of 2. </span><br />
</li>
<li><span class="math inline">\(V(t) \equiv 3 + \sin \left( \frac{\pi}{3} t \right)\)</span><span class="mcanswer"> ☹︎ Right amplitude and baseline: the minimum will be 2 liters and the maximum 4 liters. But the period is wrong. Going from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(t=3\)</span> should produce a full cycle of the sine function. But here the argument would go only from 0 to $ 3 = <span class="math inline">\(\pi\)</span>. After 3 seconds, only half a cycle has been completed. </span></li>
</ol>
<p><strong>Question B</strong> Given a respiratory period of 3 seconds/breath, what is the respiratory <strong>frequency</strong> in units of breaths/minute?</p>
<ol style="list-style-type: lower-roman">
<li>20 breaths/minute<span class="mcanswer"> ✓ Right. Each breath takes 1/20th of a minute, which is 3 seconds, the period specified in the question. </span><br />
</li>
<li>3 breaths/minute<span class="mcanswer"> ☹︎ If this were true, each breath would take 20 seconds to complete. </span><br />
</li>
<li>1/3 breath per minute<span class="mcanswer"> ☹︎ With breaths completed every three seconds, 1/3 of a breath is completed each second. But the problem asked for breaths per minute. </span><br />
</li>
<li>20 seconds per breath<span class="mcanswer"> ☹︎ The <em>period</em> is in the units of seconds per breath, but the <em>frequency</em> will have units of breaths per second. Frequency is the reciprocal of period (and vice versa). </span></li>
</ol>
<p>A respiratory cycle can be divided into two parts: inspiration and expiration. Please do an experiment. Using a clock or watch, breath with a total period of 3 seconds/breath, that is, complete one breath every three seconds. Once you have practiced this and can do it without forcing either phase of breathing, make a rough estimate of what fraction of the cycle is inspiration and what fraction is expiration. (The “correct/incorrect” answers here are right for most people. Your natural respiration might be different.)</p>
<p><strong>Question C</strong> Which is true?</p>
<ol style="list-style-type: lower-roman">
<li>Inspiration lasts longer than expiration<span class="mcanswer"> ✓ </span><br />
</li>
<li>Expiration lasts longer than inspiration<span class="mcanswer"> ☹︎ Maybe it is for you, but not for most people. Try breathing in while counting 1-2-3 then exhaling while counting 1-2-3-4-5-6. Likely, that’s not a very natural pattern for you. </span><br />
</li>
<li>Inspiration and expiration each consume about the same fraction of the complete cycle.<span class="mcanswer"> ☹︎ People can do this consciously by counting 1-2-3 for inspiration and another 1-2-3 for expiration. This usually feels forced and unnatural. </span></li>
</ol>
</details>

<div class="exercise">
<span id="exr:unnamed-chunk-56" class="exercise"><strong>Exercise 8.6  (spirometer)  </strong></span>
</div>
<details>
<p>The graph below shows a recording from a “spirometer,” an instrument for recording respiration. Like many old instruments, the trace from this spirometer is made by a pen at the end of a swinging arm with paper moving steadily beneath it. The arm is not exactly aligned with the horizontal axis. Nonetheless, you should be able to estimate an appropriate amplitude and period for the trace. (dm<span class="math inline">\(^3\)</span> is cubic-decimeters: a tenth of a meter cubed. This is the same as a liter.)</p>
<p><img src="Exercises/Fun/www/spirometer.jpg" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> What are appropriate estimates for the period and amplitude of the respiration trace?</p>
<ol style="list-style-type: lower-roman">
<li>About <span class="math inline">\(\pm 1\)</span> liter and 3 seconds.<span class="mcanswer"> ☹︎ If this were true, over the 120 seconds of the recording you would expect to see 40 cycles of respiration. </span><br />
</li>
<li>About <span class="math inline">\(\pm 1\)</span> liter and 5 seconds.<span class="mcanswer"> ✓ </span><br />
</li>
<li>About <span class="math inline">\(\pm 1\)</span> liter and 7.5 seconds.<span class="mcanswer"> ☹︎ If this were true, you would expect to see about 16 cycles of respiration over 120 seconds of recording. </span></li>
</ol>
</details>
</div>
<div id="curve-fitting-a-power-law-function" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Curve fitting a power-law function</h2>
<p>You have been using power-law functions from early in your math and science education. Some examples:</p>
<table>
<thead>
<tr class="header">
<th>Setting</th>
<th>Function formula</th>
<th>exponent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Circumference of a circle</td>
<td><span class="math inline">\(C(r) = 2 \pi r\)</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>Area of a circle</td>
<td><span class="math inline">\(A(r) = \pi r^2\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>Volume of a sphere</td>
<td><span class="math inline">\(V(r) = \frac{4}{3} \pi r^3\)</span></td>
<td>3</td>
</tr>
<tr class="even">
<td>Distance traveled by a falling object</td>
<td><span class="math inline">\(d(t) = \frac{1}{2} g t^2\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>Gas pressure versus volume</td>
<td><span class="math inline">\(P(V) = \frac{n R T}{V}\)</span></td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="even">
<td>… perhaps less familiar …</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Distance traveled by a diffusing gas</td>
<td><span class="math inline">\(X(t) = D \sqrt{ \strut t}\)</span></td>
<td><span class="math inline">\(1/2\)</span></td>
</tr>
<tr class="even">
<td>Animal lifespan (in the wild) versus body mass</td>
<td>$L(M) = a M^{0.25}</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>Blood flow versus body mass</td>
<td><span class="math inline">\(F(M) = b M^{0.75}\)</span></td>
<td>0.75</td>
</tr>
</tbody>
</table>
<p>The reason why power-law functions have their important role in science have to do with the logic of physical quantities such as length, mass, time, area, volume, force, power, and so on. We’ll discuss this at length later in the course and the principles will appear throughout calculus.</p>
<p>As for finding the power law <span class="math inline">\(f(x) \equiv A x^p\)</span> that provides a good match to data, we’ll need some additional tools to be introduced in Chapter <a href="magnitudes.html#magnitudes">14</a>.</p>
</div>
<div id="hump-and-sigmoid-functions" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Hump and sigmoid functions</h2>
<p>Our last two basic modeling functions express an important idea in modeling: <strong><em>localness</em></strong>. To put this in concrete terms, imagine creating a function to depict the elevation above sea level of a long road as a function of distance in miles, <span class="math inline">\(x\)</span>, from the start of the road. If the road were level at 1200 feet elevation, a sensible model would be <span class="math inline">\(\mbox{elevation}(x) = 1200 \text{ft}\)</span>. If the road were gently sloping, a better model would be <span class="math inline">\(\mbox{elevation}(x) = 1200 + 3 x\)</span>.</p>
<p>Now let’s add a bump to the road. A bump is a local feature, often only a few feet wide. Or, perhaps the road is crossing a mountain range. That’s also a local feature, but unlike a bump in the road a mountain range extends for many miles.</p>
<p>The basic modeling function suited to represent bumps in the road, or potholes, or mountain ranges is called a <strong><em>hump function</em></strong>.</p>
<p>A hump function has two parameters: the location of the hump, which we’ll call the <strong><em>center</em></strong> parameter, and the sideways extent of the hump, which we’ll call the <strong><em>spread</em></strong>. Figure <a href="#fig:Fun-3C-1"><strong>??</strong></a> shows a few hump functions with different parameters.</p>
<p><img src="CalcZ-notes_files/figure-html/Fun-3C-1-1.png" width="90%" style="display: block; margin: auto;" /><img src="CalcZ-notes_files/figure-html/Fun-3C-1-2.png" width="90%" style="display: block; margin: auto;" /><img src="CalcZ-notes_files/figure-html/Fun-3C-1-3.png" width="90%" style="display: block; margin: auto;" /></p>
<p>It’s easy to read off the <strong><em>center</em></strong> parameter from a graph of a hump. It’s the location of the top of the hump. (We mentioned before that a mathematical word for “the location of the top” is <strong><em>argmax</em></strong>; the value for the input of the function that produces the maximum output.)</p>
<p>The <strong><em>spread</em></strong> parameter is also pretty straightforward, but you first have to become familiar with an unusual feature of the hump function. The output of the hump function <em>far from the center</em> is practically zero. But it is not exactly zero. You can see from the graphs that the hump function has long flanks which approach zero output more or less in the manner of an exponential function. This means that we can’t measure the spread of the hump function by the distance between the zeros on either side of the peak. Instead, we need a <strong><em>convention</em></strong> that will allow us to be precise in quantifying what is admittedly a vague concept of width.</p>
<p>A simple convention is that the spread is the “half-width at half-height.” Come down half-way from the peak of the hump. Panel (c) of Figure <a href="#fig:Fun-3C-1"><strong>??</strong></a> marks that elevation with a thin, red, horizontal line. Along that line, measure the width of the hump, as marked by the thick red line in Panel (c). The <strong><em>spread</em></strong> parameter is half the width of the hump measured in this way.</p>
<p>If you have a keen eye, you’ll notice that the red line is not exactly half-way down from the peak. It’s down 39.35% from the peak. The official definition of width of a hump is not actually half-width at half-height, but that simple formulation will do for us for the present.</p>
<p>Another seeming oddity about the hump function is the value of the maximum. It would have seemed natural to define this as 1, so-called “unit height.” The way it actually works is different: the maximum height is set so that the <strong><em>area</em></strong> under the hump function is 1.</p>
<p>This business with the area will make more sense when you’ve learned some calculus tools, specifically “differentation” and “integration.” For now though …</p>
<p>Consider another road feature, a local <strong><em>change</em></strong> from one elevation to another as you might accomplish with a ramp. The basic modeling function corresponding to a <strong><em>local change</em></strong> from one level to another is the <strong><em>sigmoid</em></strong> function. Figure <a href="#fig:Fun-3C-2"><strong>??</strong></a> shows three sigmoid functions.</p>
<p><img src="CalcZ-notes_files/figure-html/Fun-3C-2-1.png" width="90%" style="display: block; margin: auto;" /><img src="CalcZ-notes_files/figure-html/Fun-3C-2-2.png" width="90%" style="display: block; margin: auto;" /><img src="CalcZ-notes_files/figure-html/Fun-3C-2-3.png" width="90%" style="display: block; margin: auto;" />
The name “sigmoid” comes from vague resemblance of the graph to the letter S (which is “sigma” in Greek: ς).</p>
<p>The parameters of the sigmoid function are the same as for the hump function: <strong><em>center</em></strong> and <strong><em>width</em></strong>. The center is easy to estimate from a graph. It’s the value of the input that produces an output of 0.5, half-way between the max and min of the sigmoid. As with the hump function, the <strong><em>width</em></strong> is measured according to a convention. The width is the <strong><em>change in input</em></strong> needed to go from an output of 0.5 to an output of 0.8413. This use of 0.8413 must seem loony at first exposure, but there is a reason. We’ll need more calculus tools before it can make sense.</p>
<p>Hump functions and sigmoid functions with the same center and width parameters have a very close relationship. The <strong><em>slope</em></strong> of the sigmoid function is the corresponding <strong><em>hump</em></strong> function. Figures <a href="#fig:Fun-3C-1"><strong>??</strong></a> and <a href="#fig:Fun-3C-2"><strong>??</strong></a> show corresponding hump and sigmoid functions. To the very far left, the sigmoid function is effectively flat: a slope near zero. Moving toward the center the sigmoid has a gentle slope: a low number. In the center, the sigmoid is steepest: a higher number. Then the slope of the sigmoid becomes gentle again before gradually falling off to zero. Near zero, then low, then higher, then low again, then falling off to zero: that’s also the description of a hump function!</p>
<p>In R, the name of the sigmoid function is <code>pnorm()</code>. The hump is <code>dnorm()</code>. The parameters that specify center and spread are named <code>mean</code> and <code>sd</code>. The word “mean” accurately conveys the idea of “center.” It would be nice to be able to say that <code>sd</code> comes from <code>s</code>prea<code>d</code>, but in fact <code>sd</code> is short for <strong><em>standard deviation</em></strong>, a old-fashioned term familiar to students of statistics.</p>
<div class="why">
<p>“Standard deviation” is off-putting to many people and it really should be replaced with something less weird, perhaps <strong><em>typical spread</em></strong>. The “standard” can be interpreted as “widely used convention.” What about “deviation?” The hump function first appeared two-hundred years ago as part of a theory of measurement error. In the context of “error,” “deviation” might have made sense. But the theory of measurement error long ago became a more general theory of <strong><em>variation</em></strong>. Errors are just one source of variation.</p>
</div>

<div class="exercise">
<span id="exr:unnamed-chunk-57" class="exercise"><strong>Exercise 8.7  (hump-intro)  </strong></span>
</div>
<details>
<p>The hump function that we mainly use in CalcZ is implemented in R with <code>dnorm(x, mean, sd)</code>. The input called <code>mean</code> corresponds to the <em>center</em> of the hump. The input called <code>sd</code> gives the <em>width</em> of the hump.</p>
<div class="scaffolding">
<p>In a sandbox, make a slice plot of <code>dnorm(x, mean=0, sd=1)</code>. By varying the value of <code>width</code>, figure out how you could read that value directly from the graph.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="process-of-modeling.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>) <span class="sc">~</span> x,</span>
<span id="cb39-2"><a href="process-of-modeling.html#cb39-2" aria-hidden="true" tabindex="-1"></a>           <span class="fu">domain</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)))</span></code></pre></div>
</div>
<p>In the plot below, one of the double-headed arrows represents the <code>width</code> parameter. The others are misleading.</p>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-247-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> Which arrow shows correctly the <code>width</code> parameter of the hump function in the graph with arrows?</p>
<p>    top<span class="mcanswer"> ✓ </span>       middle<span class="mcanswer"> ☹︎ </span>       bottom<span class="mcanswer"> ☹︎ </span>       none of them<span class="mcanswer"> ☹︎ </span></p>
<p><strong>Question B</strong> What is the value of <code>center</code> in the graph with arrows?</p>
    -2<span class="mcanswer"> ☹︎ The <code>center</code> parameter is the argmax of the function. </span>       -1<span class="mcanswer"> ☹︎ The <code>center</code> parameter is the argmax of the function. </span>       -0.5<span class="mcanswer"> ☹︎ The <code>center</code> parameter is the argmax of the function. </span>       0<span class="mcanswer"> ☹︎ The <code>center</code> parameter is the argmax of the function. </span>       0.5<span class="mcanswer"> ✓ </span>       1<span class="mcanswer"> ☹︎ The <code>center</code> parameter is the argmax of the function. </span>       2<span class="mcanswer"> ☹︎ The <code>center</code> parameter is the argmax of the function. </span>
</details>

<div class="exercise">
<span id="exr:unnamed-chunk-58" class="exercise"><strong>Exercise 8.8  (sigmoid-intro)  </strong></span>
</div>
<details>
<p>Hump functions and sigmoidal functions come in pairs. For every possible sigmoid, there is a corresponding hump that gives, for each value of the input, the slope of the sigmoid.</p>
<p>Each of the following graphs shows a sigmoid and a hump function. The two might or might not correspond to one another. That is, the output of the hump might be the slope of the sigmoid, or the hump might correspond to some other sigmoid. Remember, you’re comparing the <em>output</em> of the hump to the <em>slope</em> of the sigmoid.</p>
<p>For each graph, say whether the hump and the sigmoid correspond to one another. If not, choose one of the reasons why not.</p>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-249-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> Graph (A)</p>
<ol style="list-style-type: lower-roman">
<li>The hump and sigmoid correspond.<span class="mcanswer"> ✓ </span><br />
</li>
<li>The peak of the hump does not occur at the same value of <span class="math inline">\(x\)</span> at which the sigmoid is steepest.<span class="mcanswer"> ☹︎ For what <span class="math inline">\(x\)</span> is the sigmoid the steepest? For what <span class="math inline">\(x\)</span> is the hump the highest? </span><br />
</li>
<li>The numerical value of the output of the hump function is, for all <span class="math inline">\(x\)</span>, much larger than the numerical value of the <em>slope</em> of the sigmoid.<span class="mcanswer"> ☹︎ Did you calculate the numerical value of the slope of the sigmoid? </span></li>
</ol>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-250-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question B</strong> Graph (B)</p>
<ol style="list-style-type: lower-roman">
<li>The hump and sigmoid correspond.<span class="mcanswer"> ☹︎ </span><br />
</li>
<li>The peak of the hump does not occur at the same value of <span class="math inline">\(x\)</span> at which the sigmoid is steepest.<span class="mcanswer"> ✓ The hump peaks at about <span class="math inline">\(x=2\)</span> while the steepest part of the sigmoid is at about <span class="math inline">\(x=4\)</span> </span><br />
</li>
<li>The numerical value of the output of the hump function is much larger than the numerical value of the <em>slope</em> of the sigmoid.<span class="mcanswer"> ☹︎ Did you calculate the numerical value of the slope of the sigmoid? </span></li>
</ol>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-251-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question C</strong> Graph (C)</p>
<ol style="list-style-type: lower-roman">
<li>The hump and sigmoid correspond.<span class="mcanswer"> ✓ </span><br />
</li>
<li>The peak of the hump does not occur at the same value of <span class="math inline">\(x\)</span> at which the sigmoid is steepest.<span class="mcanswer"> ☹︎ For what <span class="math inline">\(x\)</span> is the sigmoid the steepest? For what <span class="math inline">\(x\)</span> is the hump the highest? </span><br />
</li>
<li>The numerical value of the output of the hump function is, for all <span class="math inline">\(x\)</span>, much larger than the numerical value of the <em>slope</em> of the sigmoid.<span class="mcanswer"> ☹︎ Did you calculate the numerical value of the slope of the sigmoid? </span></li>
</ol>
<p>In the graph <em>D</em>, there are several hump functions shown, only one of which corresponds to the sigmoid.</p>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-252-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question D</strong> Which hump corresponds to the sigmoid?</p>
    A<span class="mcanswer"> ☹︎ The value of the hump output is much larger than the slope of the sigmoid. </span>       B<span class="mcanswer"> ✓ Right! The hump is centered on the steepest part of the sigmoid and falls to zero where the sigmoid levels out. </span>       C<span class="mcanswer"> ☹︎ The hump is too narrow. </span>       D<span class="mcanswer"> ☹︎ The hump is too broad and shifted to the left. </span>
</details>

<div class="exercise">
<span id="exr:unnamed-chunk-59" class="exercise"><strong>Exercise 8.9  (sigmoid-bath)  </strong></span>
</div>
<details>
<p>Have in mind a hump function and a sigmoid function that form a corresponding pair.</p>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-254-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> Which of these stories is consistent with the relationship between a hump and its corresponding sigmoid?</p>
<ol style="list-style-type: lower-roman">
<li>The hump is the amount of water in a bathtub while the sigmoid is the time you spend in the bath.<span class="mcanswer"> ☹︎ </span><br />
</li>
<li>The hump is the amount of water in the bathtub while the sigmoid is the rate at which water flows from the tap.<span class="mcanswer"> ☹︎ You turn the tap on and off after a while. That’s not what the sigmoid looks like. </span><br />
</li>
<li>The hump is the rate at which water flows from the tap and the sigmoid is the amount of water in the bathtub.<span class="mcanswer"> ✓ </span><br />
</li>
<li>The hump indicates the amount the drain is open and the sigmoid is the amount of water in the bathtub.<span class="mcanswer"> ☹︎ Shouldn’t the amount of water go down when the drain is open? </span></li>
</ol>
</details>

<div class="exercise">
<span id="exr:unnamed-chunk-60" class="exercise"><strong>Exercise 8.10  (ebola-sigmoid)  </strong></span>
</div>
<details>
<p>A data frame named <code>EbolaSierraLeone</code><a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> records the cumulative number of Ebola cases in Sierra Leone from May 1, 2014 to December 16, 2015.</p>
<p>Let’s find how well a sigmoidal function models the data.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="process-of-modeling.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(Cases <span class="sc">~</span> Day, <span class="at">data =</span> MMAC<span class="sc">::</span>EbolaSierraLeone)</span></code></pre></div>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-256-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>It’s straightforward to estimate the values of the parameters from data that have a sigmoidal form. To walk you through the process, the next plot shows simulated data from a genuine sigmoid function.</p>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-257-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ol style="list-style-type: decimal">
<li><p>Sketch in a S-shaped curve that smoothly follows the data.</p></li>
<li><p>Find the top plateau of the S-curve. This is indicated by the red line in the graph above. The parameter <code>A</code> is simply the height of the plateau, in this case <span class="math inline">\(y \approx 15\)</span>.</p></li>
<li><p>Come down half way from the plateau. Here, that’s 15/2 or 7.5, indicated by the horizontal blue line segment. Find the inverse of the S-curve from that half-way point onto the horizontal-axis. Here, that gives <span class="math inline">\(t \approx 5\)</span>. The parameter <code>center</code> is that value.</p></li>
<li><p>From the center of the S-shaped curve, follow the curve upward about 2/3 of the way to the plateau. In the diagram, that point is marked with a green line at <span class="math inline">\(t \approx 7\)</span>. The <code>width</code> is the distance along the horizontal axis from the blue centerline to the green line. Here, that’s <span class="math inline">\(7 - 5\)</span> giving 2 as the <code>width</code>.</p></li>
<li><p>You might also want to trace the S-curve <em>downward</em> from the centerline about 2/3 of the way to zero. That’s indicated by the left green line. In the standard sigmoid, the two green lines will be equally spaced around the centerline. Of course the data may not be in the shape of the standard sigmoid, so you might find the two green lines are not equally spaced from the center.</p></li>
</ol>
<hr />
<p><em>Put aside for the moment that the Ebola data doesn’t look exactly like the standard sigmoid function. Follow the above procedure, nevertheless.</em></p>
<p><strong>Question A</strong> Where is the top plateau?</p>
<ol style="list-style-type: lower-roman">
<li>About Day 600.<span class="mcanswer"> ☹︎ Measure the height of the plateau, not where it starts horizontally. </span><br />
</li>
<li>About 14,000 cases<span class="mcanswer"> ✓ </span><br />
</li>
<li>About 20,000 cases<span class="mcanswer"> ☹︎ Read the vertical axis markings more carefully. </span><br />
</li>
<li>None of the above<span class="mcanswer"> ☹︎ One of the above answers is pretty good. </span></li>
</ol>
<p><strong>Question B</strong> Where is the centerline?</p>
<ol style="list-style-type: lower-roman">
<li>Near Day 200<span class="mcanswer"> ✓ </span><br />
</li>
<li>Near Day 300<span class="mcanswer"> ☹︎ That’s the center of the vertical scale, not the day at which the curve reaches half-way to the eventual plateau. </span><br />
</li>
<li>At about 7000 cases<span class="mcanswer"> ☹︎ That’s half-way up to the plateau, but the answer you want is the day at which the curve reaches that point. </span></li>
</ol>
<p><strong>Question C</strong> Now to find the <code>width</code> parameter. The curve looks more classically sigmoidal to the left of the centerline than to the right, so follow the curve <em>downward</em> as in Step 4 of the algorithm to find the parameters. What’s a good estimate for <code>width</code>?</p>
<ol style="list-style-type: lower-roman">
<li>About 50 days<span class="mcanswer"> ✓ </span><br />
</li>
<li>About 100 days<span class="mcanswer"> ☹︎ Too wide! </span><br />
</li>
<li>About 10 days<span class="mcanswer"> ☹︎ Too small </span><br />
</li>
<li>About 2500 cases<span class="mcanswer"> ☹︎ The width is measured along the horizontal axis, not the vertical </span></li>
</ol>
<p>Open a sandbox and use the following commands to plot the Ebola data along with the sigmoid that you matched to the data by eye. The commands also generate and plot a more “refined” estimate found with <code>fitModel()</code> starting with your by-eye parameters. (Note: You’ll need to fill in the blanks at the start of the scaffolding with your by-eye parameters before running the code.)</p>
<div class="scaffolding">
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="process-of-modeling.html#cb41-1" aria-hidden="true" tabindex="-1"></a>A_estimate <span class="ot">&lt;-</span>  _____</span>
<span id="cb41-2"><a href="process-of-modeling.html#cb41-2" aria-hidden="true" tabindex="-1"></a>center_estimate <span class="ot">&lt;-</span> _____</span>
<span id="cb41-3"><a href="process-of-modeling.html#cb41-3" aria-hidden="true" tabindex="-1"></a>width_estimate <span class="ot">&lt;-</span> ______</span>
<span id="cb41-4"><a href="process-of-modeling.html#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="process-of-modeling.html#cb41-5" aria-hidden="true" tabindex="-1"></a>guessed_fun <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(A<span class="sc">*</span> <span class="fu">pnorm</span>(Day, center, width) <span class="sc">~</span> Day,</span>
<span id="cb41-6"><a href="process-of-modeling.html#cb41-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">A =</span> A_estimate,</span>
<span id="cb41-7"><a href="process-of-modeling.html#cb41-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">center =</span> center_estimate,</span>
<span id="cb41-8"><a href="process-of-modeling.html#cb41-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">width =</span> width_estimate)</span>
<span id="cb41-9"><a href="process-of-modeling.html#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="process-of-modeling.html#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="process-of-modeling.html#cb41-11" aria-hidden="true" tabindex="-1"></a>refined_fun <span class="ot">&lt;-</span> <span class="fu">fitModel</span>(Cases <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">pnorm</span>(Day, center, width),</span>
<span id="cb41-12"><a href="process-of-modeling.html#cb41-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> EbolaSierraLeone,</span>
<span id="cb41-13"><a href="process-of-modeling.html#cb41-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A=</span>A_estimate, </span>
<span id="cb41-14"><a href="process-of-modeling.html#cb41-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">center=</span>center_estimate,</span>
<span id="cb41-15"><a href="process-of-modeling.html#cb41-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">width=</span>width_estimate))</span>
<span id="cb41-16"><a href="process-of-modeling.html#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="process-of-modeling.html#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(Cases  <span class="sc">~</span> Day, <span class="at">data =</span> MMAC<span class="sc">::</span>EbolaSierraLeone)  <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="process-of-modeling.html#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">guessed_fun</span>(Day) <span class="sc">~</span> Day, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="process-of-modeling.html#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">refined_fun</span>(Day) <span class="sc">~</span> Day, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
</div>
<p>I can’t predict what you see in your graph, since it depends on what starting estimates you used for <code>A</code>, <code>center</code> and <code>width</code>.</p>
<p><strong>Essay question tmp-3</strong>: Write down the estimates you made by eye for <code>A</code>, <code>center</code> and <code>width</code>. Then explain in words any major systematic deviations of the ‘refined’ model from the data.</p>
<p>This idea of fitting a sigmoidal curve <em>globally</em> to data that are only roughly sigmoidal might be forgiven since it’s just a textbook exercise. But if this were a real-world problem, there are three rookie mistakes in the approach, despite its technical sophistication.</p>
<ol style="list-style-type: decimal">
<li>A model is built for a purpose. There’s no statement in the exercise about what the purpose is.</li>
<li>The data themselves are a good enough representation of the historical pattern. There’s no need to adorn them with a fitted curve.</li>
<li>The mathematical processes that would justify the expectation that a sigmoid curve could be useful are based on the idea that the underlying mechanism for the phenomenon is unchanging. For an epidemic, that mechanism is contagion. By saying the “mechanism is unchanging,” we mean that person-to-person transmission of the Ebola virus happens in the same way at the beginning of the epidemic as it does in the middle and in the end. But strong public health interventions were introduced to control the epidemic. That’s a change in mechanism.</li>
</ol>
</details>
</div>
<div id="modeling-cycle" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> The modeling cycle</h2>
<p>Effective modelers treat models with skepticism. They look for ways in which models failure to capture salient features of the real world. They have an eye out for deviations between what their models show and what they believe they know about the system being modeled. They consider ways in which the models might not serve the purpose for which they were developed.</p>
<p>When modelers spot a failure or deviation or lack of proper utility, they might discard the model but more often they make a series of small adjustments, tuning up the model until is successfully serves the purposes for which it is intended.</p>
<p>Thus, modeling is a cyclic process of creating a model, assessing the model, and revising the model. The process comes to a sort of preliminary end when the model serves its purposes. But even then, models are often revised to check whether the results are sensitive to some factor that was not included or to check whether some component that was deemed essential really is so.</p>
<div id="example-cooling-water" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Example: Cooling water</h3>
<p>Looking back on the exponential fitted to the cooling water data in Section <a href="process-of-modeling.html#fit-exponential">8.2</a>, it looks like our original estimate of the half-life is a bit too small; the data doesn’t seem to decay at the rate implied by <span class="math inline">\(k = -0.0277\)</span>. Perhaps we should try a somewhat slower decay, say <span class="math inline">\(k = -0.2\)</span> and see if that improves things.</p>
<div class="scaffolding">
<p>In the cooling water example, we’re using only a subset of the data collected by Prof. Wagon. The next commands re-create that subset so that you can work with it. They also plot the data and an exponential model.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="process-of-modeling.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reconstruct the sample</span></span>
<span id="cb42-2"><a href="process-of-modeling.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb42-3"><a href="process-of-modeling.html#cb42-3" aria-hidden="true" tabindex="-1"></a>Stans_data <span class="ot">&lt;-</span> CoolingWater <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">20</span>)</span>
<span id="cb42-4"><a href="process-of-modeling.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the sample and overlay a model</span></span>
<span id="cb42-5"><a href="process-of-modeling.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(temp <span class="sc">~</span> time, <span class="at">data=</span>Stans_data) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="process-of-modeling.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="process-of-modeling.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="dv">25</span> <span class="sc">+</span> <span class="fl">83.3</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">0277</span><span class="sc">*</span>time) <span class="sc">~</span> time, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-61-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>See if <span class="math inline">\(k=-0.02\)</span> provides a better fit to the model. (You can add another <code>slice_plot()</code> to be able to compare the original and <span class="math inline">\(k=-0.02\)</span> models.)</p>
</div>
<p>Later in CalcZ, we’ll study <strong><em>optimization</em></strong>. There are optimization techniques for directing the computer to refine the parameters to best match the data. Just to illustrate, here’s what we get:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="process-of-modeling.html#cb43-1" aria-hidden="true" tabindex="-1"></a>refined_params <span class="ot">&lt;-</span> </span>
<span id="cb43-2"><a href="process-of-modeling.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitModel</span>(temp <span class="sc">~</span> A <span class="sc">+</span> B<span class="sc">*</span><span class="fu">exp</span>(k<span class="sc">*</span>time), <span class="at">data =</span> Stans_data, </span>
<span id="cb43-3"><a href="process-of-modeling.html#cb43-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">25</span>, <span class="at">B =</span> <span class="fl">83.3</span>, <span class="at">k =</span> <span class="sc">-</span><span class="fl">0.0277</span>))</span>
<span id="cb43-4"><a href="process-of-modeling.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(refined_params)</span></code></pre></div>
<pre><code>##           A           B           k 
## 25.92628463 60.69255269 -0.01892572</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="process-of-modeling.html#cb45-1" aria-hidden="true" tabindex="-1"></a>new_f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(refined_params)</span>
<span id="cb45-2"><a href="process-of-modeling.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(temp <span class="sc">~</span> time, <span class="at">data =</span> Stans_data) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="process-of-modeling.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">new_f</span>(time) <span class="sc">~</span> time, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-2-3"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-2-3-1.png" alt="Polishing the fit using the rough model as a starting point." width="90%" />
<p class="caption">
Figure 8.8: Polishing the fit using the rough model as a starting point.
</p>
</div>
<p>The refined parameters give a much better fit to the data than our original rough estimates by eye.</p>
<p>We had two rounds of the <strong><em>modeling cycle</em></strong>. First, choice of an A/B expontential model and a rough estimate of the parameters A, B, and <span class="math inline">\(k\)</span>. Second, refinement of those parameters using the computer.</p>
<p>Looking at the results of the second round, the experienced modeler can see some disturbing discrepancies. First, the estimated baseline appears to be too high. Related, the initial decay of the model function doesn’t seem to be fast enough and the decay of the model function for large <span class="math inline">\(t\)</span> appears to be too slow. Prof. Stan Wagon noticed this. He used additional data to fill in the gaps for small <span class="math inline">\(t\)</span> and refined his model further by changing the basis functions in the linear combination. He hypothesized that there are at least two different cooling processes. First, the newly poured water raises the temperature of the mug itself. Since the water and mug are in direct contact, this is a fast process. Then, the complete water/mug unit comes slowly into equilibrium with the room temperature.</p>
<p>The newly refined model was a even better match to the data. But nothing’s perfect and Prof. Wagon saw an opportunity for additional refinement based on the idea that there is a third physical mechanism of cooling: evaporation from the surface of the hot water. Prof. Wagon’s additional circuits of the modeling cycle were appropriate to his purpose, which was to develop a detailed understanding of the process of cooling. For other purposes, such as demonstrating the appropriateness of an exponential process or interpolating between the data points, earlier cycles might have sufficed.</p>
<p>Here’s a graph of the model Prof. Wagon constructed to match the data.</p>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-2-4"></span>
<img src="www/Wagon-water-fit.png" alt="A model that combines three exponentials provides an excellent fit." width="70%" />
<p class="caption">
Figure 8.9: A model that combines three exponentials provides an excellent fit.
</p>
</div>
<p>This is an excellent match to the data. But … matching the data isn’t always the only goal of modeling. Prof. Wagon wanted to make sure the model was physically plausible. And looking at the refined parameters, which include two exponential processes with parameters <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span>, he saw something wrong:</p>
<blockquote>
<p><em>But what can we make of <span class="math inline">\(k_1\)</span>, whose [positive value] violates the laws of thermodynamics by suggesting that the water gets hotter by virtue of its presence in the cool air? The most likely problem is that our simple model (the proportionality assumption) is not adequate near the boiling point. There are many complicated factors that affect heat transportation, such as air movement, boundary layer dissipation, and diffusion, and our use of a single linear relationship appears to be inadequate. In the next section [of our paper] we suggest some further experiments, but we also hope that our experiments might inspire readers to come up with a better mathematical model.</em></p>
</blockquote>
<p>The modeling cycle can go round and round!</p>
</div>
<div id="example-the-tides" class="section level3" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Example: The tides</h3>
<p><strong>Step 4</strong>: Evaluate and refine. The green model would make poor predictions. The model says “high tide” when the data say otherwise. What’s missing is the <strong><em>phase</em></strong> of the sinusoid. A model that incorporates the phase is</p>
<p><span class="math display">\[{\color{blue}\mbox{tide}(t) \equiv 1.05 + 0.55 \sin(2\pi (t - t_0)/11)}\]</span></p>
<p>The new parameter, <span class="math inline">\(t_0\)</span>, should be set to be the time of a positive-going crossing of the baseline. There’s such a crossing at about time = 17. Happily, changing the phase does not itself necessitate re-estimating the other parameters: baseline, amplitude, period. This model, incorporating the phase, has been graphed in <span class="math inline">\(\color{blue}\mbox{blue}\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-3-4"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-4-1.png" alt="Shifting the **phase** of the sinusoid gives the flexibility needed to align the peaks and troughs of the model with the data. Performing this alignment for one peak makes it clear that the period is wrong." width="50%" /><img src="CalcZ-notes_files/figure-html/Fun-4-a-3-4-2.png" alt="Shifting the **phase** of the sinusoid gives the flexibility needed to align the peaks and troughs of the model with the data. Performing this alignment for one peak makes it clear that the period is wrong." width="50%" />
<p class="caption">
Figure 8.10: Shifting the <strong>phase</strong> of the sinusoid gives the flexibility needed to align the peaks and troughs of the model with the data. Performing this alignment for one peak makes it clear that the period is wrong.
</p>
</div>
<p>For some modeling purposes, such as prediction of future tides, the phase information is impossible. For others, say, description of the amplitude of the tides, not. But getting the phase roughly right can help point out other problems. For instance, having the blue sinusoid for comparison makes it clear that the estimated period of 11 hours is too short. Maybe 13 hours would be better. Better still, since at <span class="math inline">\(t=t_0 = 17\)</span> the model is a close match to the data, let’s use that as the estimate of the start of a cycle. But then, let’s move much further along in the data to find another baseline crossing. To judge from the right panel, there is a baseline crossing at <span class="math inline">\(t=103\)</span>. The difference between these two times is <span class="math inline">\(103 - 17 = 86\)</span> hours. Of course, the period is not 86 hours. Looking back at the whole set of data we can see 7 complete cycles between <span class="math inline">\(t=17\)</span> and <span class="math inline">\(t=103\)</span>. So our new estimate of the period is <span class="math inline">\(86/7 = 12.3\)</span> hours.</p>
<p>With this refinement the model is
<span class="math display">\[{\color{violet}\mbox{tide}(t) \equiv 1.05 + 0.55 \sin(2\pi (t - 17)/12.3)}\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-3-5"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-5-1.png" alt="With the phase about right, a better estimate can be made of the period: 12.3 hours." width="90%" />
<p class="caption">
Figure 8.11: With the phase about right, a better estimate can be made of the period: 12.3 hours.
</p>
</div>
<p>That’s a pretty good match to the data! We might call it quits at that. First, let’s polish up the parameter estimates, letting the computer do the tedious work of trying little tweaks to see if it can improve the fit.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="process-of-modeling.html#cb46-1" aria-hidden="true" tabindex="-1"></a>tide_mod <span class="ot">&lt;-</span> </span>
<span id="cb46-2"><a href="process-of-modeling.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitModel</span>(level <span class="sc">~</span> A <span class="sc">+</span> B<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>(hour<span class="sc">-</span>hzero)<span class="sc">/</span>P),</span>
<span id="cb46-3"><a href="process-of-modeling.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> RI_tide,</span>
<span id="cb46-4"><a href="process-of-modeling.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start=</span><span class="fu">list</span>(<span class="at">A=</span><span class="fl">1.05</span>, <span class="at">B=</span><span class="fl">0.55</span>, <span class="at">hzero=</span><span class="dv">17</span>, <span class="at">P=</span><span class="fl">12.3</span>))</span>
<span id="cb46-5"><a href="process-of-modeling.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(tide_mod)</span></code></pre></div>
<pre><code>##          A          B      hzero          P 
##  1.0220540  0.4998367 15.3899905 12.5593556</code></pre>
<div class="figure" style="text-align: center"><span id="fig:Fun-4-a-3-6"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-6-1.png" alt="Polishing the parameters of the sinusoid" width="90%" />
<p class="caption">
Figure 8.12: Polishing the parameters of the sinusoid
</p>
</div>
<p>This last model seems capable of making reasonable predictions, so if we collected up-to-date data we might be able to fit a new model to predict the tide level pretty accurately a few days ahead of time. Also, the excellent alignment of the model peaks with the data tell us that the cyclic tide has a period that constant, at least so far as well can tell.</p>
<p>With the period estimate <span class="math inline">\(P=12.56\)</span> hours, we can go looking for other phenomena that might account for the tides. The period of the day-night cycle is, of course 24 hours. So the tides in Providence come in and out twice a day. But not exactly. Something else must be going on.</p>
<p>Isaac Newton was the first to propose that the tides were caused by the gravitational attraction of the Moon. A complete cycle of the Moon—moon rise to moon rise—takes about 50 minutes longer than a full day: the Earth revolves once every 24 hours, but in that time the Moon has moved a bit further on in its orbit of the Earth. So the Moon’s period, seen from a fixed place on Earth is about 24.8 hours. Half of this, 12.4 hours, is awfully close to our estimate of the tidal period: 12.56 hours. The difference in periods, 8 minutes a day, might be hard to observe over only 4 days. Maybe with more data we’d get a better match between the tides and the moon.</p>
<p>This is the modeling cycle at work: Propose a model form (A/B model with sinusoid), adjust parameters to match what we know (the Providence tide record), compare the model to the data, observe discrepancies, propose a refined model. You can stop the model when it is giving you what you need. The period 12.56 hour model seems good enough to make a prediction of the tide level a few days ahead, and is certainly better than the “two tides a day” model. But our model is not yet able to implicate precisely the Moon’s orbit in in tidal oscillations.</p>
<p>Discrepancies between a model and data play two roles: they help us decide if the model is fit for the purpose we have in mind and they can point the way to improved models. That the tidal data deviates from the steady amplitude of our model can be a clue for where to look next. It’s not always obvious where this will lead.</p>
<p>Historically, careful analysis of tides led to a highly detailed, highly accurate model: a linear combination of sinusoids with diurnal periods 12.42, 12.00, 12.66, and 11.97 hours as well components with period 23.93, 25.82, 24.07, 26.87, and 24.00 hours. A tide-prediction model is constructed by finding the coefficients of the linear combination; these differ from locale to locale.</p>

<div class="exercise">
<span id="exr:daylength" class="exercise"><strong>Exercise 6.2  (sunset-in-LA)  </strong></span>
</div>
<details>
<p>The data frame <code>SunsetLA</code> records the number of minutes after 4 pm until the sun sets in Los Angeles, CA over a 4-year interval from January 2010 (month 1) through December 2013 (month 48).</p>
<!-- (All times are already adjusted for daylight savings time. The book doesn't tell us whether the value for each month is an average over all days or for a particular day of the month.) -->
<p>Open a sandbox and make a plot of sunset time versus month.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="process-of-modeling.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(Minutes <span class="sc">~</span> Month, <span class="at">data =</span> SunsetLA) <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="process-of-modeling.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_line</span>()</span></code></pre></div>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-260-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We’re using both <code>gf_point()</code> and <code>gf_line()</code>. With data that oscillates up and down, connecting the data points with lines makes it easier to see the pattern.</p>
</div>
<p><strong>Question A</strong> What is the range of the number of minutes until sunset over the whole 4-year period?</p>
<ol style="list-style-type: lower-roman">
<li>40 to 190 minutes<span class="mcanswer"> ✓ </span><br />
</li>
<li>120 minutes<span class="mcanswer"> ☹︎ A range is an interval spanned by <em>two</em> numbers. </span><br />
</li>
<li>40 to 180 minutes<span class="mcanswer"> ☹︎ The largest values are half a tick mark up from 180. Tick marks are spaced by 20 minutes. </span><br />
</li>
<li>0 to 48 months<span class="mcanswer"> ☹︎ That’s the <em>domain</em>. The <em>range</em> is along the vertical axis. </span></li>
</ol>
<p><strong>Question B</strong> The data fall nicely on a sine-shaped curve. What is the period of that sine?</p>
<p>    6 months<span class="mcanswer"> ☹︎ Look at the number of months from one peak to another. </span>       11 months<span class="mcanswer"> ☹︎ Look more carefully. And remember that the change in length of day is an <em>annual</em> phenomenon. </span>       12 months<span class="mcanswer"> ✓ </span>       12 minutes<span class="mcanswer"> ☹︎ Period refers to an interval on the <em>domain</em> of the function, not the range. </span></p>
<p>The function <span class="math display">\[\mbox{sunset}(\mbox{Month}) \equiv A  \sin(2 \pi\, \mbox{Month} / 12) + C\]</span> is a <em>linear combination</em> of two functions:</p>
<ol style="list-style-type: decimal">
<li>The constant function <code>one(Month)</code></li>
<li>The sine function <code>sin(2*pi*Month/12)</code></li>
</ol>
<p>The two functions are scaled by <span class="math inline">\(C\)</span> and <span class="math inline">\(A\)</span>, respectively.</p>
<p>You can estimate <span class="math inline">\(C\)</span> by the mid-point of the range (in minutes) of the data. You can estimate <span class="math inline">\(A\)</span> as half the length of the range (that is, half the max minus the min.)</p>
<p>Make rough but reasonable numeric estimates for <span class="math inline">\(C\)</span> and <span class="math inline">\(A\)</span> from the data. Then, in the sandbox, define the <code>sunset()</code> function using the numerical estimates in the linear combination. Plot your function as a layer on top of the data. (Pipe the <code>gf_point()</code> layer to <code>slice_plot()</code>.)</p>
<div class="scaffolding">
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="process-of-modeling.html#cb49-1" aria-hidden="true" tabindex="-1"></a>sunset <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(A <span class="sc">+</span> C<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>(Month <span class="sc">-</span> offset)<span class="sc">/</span><span class="dv">12</span>), </span>
<span id="cb49-2"><a href="process-of-modeling.html#cb49-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">A =</span> __your estimate__, </span>
<span id="cb49-3"><a href="process-of-modeling.html#cb49-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">C =</span> __your estimate__,</span>
<span id="cb49-4"><a href="process-of-modeling.html#cb49-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">offset=</span><span class="dv">0</span>)</span>
<span id="cb49-5"><a href="process-of-modeling.html#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(Minutes <span class="sc">~</span> Month, <span class="at">data =</span> SunsetLA) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="process-of-modeling.html#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_line</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-7"><a href="process-of-modeling.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">sunset</span>(Month) <span class="sc">~</span> Month)</span></code></pre></div>
<p>The domain for <code>slice_plot()</code> is inherited to that implied by the <code>SunsetLA</code> data. Notice that the input name in <code>slice_plot()</code> corresponds to that established in <code>gf_point()</code>.</p>
</div>
<p><strong>Question C</strong> Your <code>sunset()</code> function should be a pretty good match to the data except for one thing. What is that thing?</p>
<ol style="list-style-type: lower-roman">
<li>The <code>sunset()</code> function has a completely different range than the data.<span class="mcanswer"> ☹︎ This won’t be the case if you have estimated <span class="math inline">\(C\)</span> and <span class="math inline">\(A\)</span> correctly. </span><br />
</li>
<li>The period of the <code>sunset()</code> function doesn’t match the data.<span class="mcanswer"> ☹︎ Did you use <code>sin(2*pi*Month/12)</code>? If so, the period should be right. </span><br />
</li>
<li>There is a horizontal time shift between <code>sunset()</code> and the data.<span class="mcanswer"> ✓ </span></li>
</ol>
<p>We’re going to fix the problem with <code>sunset()</code> by defining a <em>time offset</em> to use as a reference. For a sine function, a suitable time offset is the value along the horizontal axis when the phenomenon being modeled crosses <span class="math inline">\(C\)</span> with a positive slope. There are 4 such points along the horizontal axis readily identifiable in the data. (They may not be at an integer value of <code>Month</code>.)</p>
<p><strong>Question D</strong> Which of these is a suitable value for the time offset?</p>
<p>    0 months<span class="mcanswer"> ☹︎ That’s not a time when the data suggest that <span class="math inline">\(C\)</span> is being crossed. </span>       19 months<span class="mcanswer"> ☹︎ That’s a maximum, not a crossing of <span class="math inline">\(C\)</span>. </span>       21.5 months<span class="mcanswer"> ☹︎ That’s a crossing of <span class="math inline">\(C\)</span>, but not one with a positive slope. </span>       15.5 months<span class="mcanswer"> ✓ This is a good rough value. Since the period is 12 months, you could equally well have said the offset is 3.5 months. </span></p>
<p>In the original scaffolding, the value of <code>offset</code> was zero. Change that to match your answer to the previous question.</p>
<p>Plot out the modified <code>sunset()</code> function and confirm that it is a much better match to the data than the original (that is, the one without the time offset). You can “tune” your function by tweaking the numerical values of the <span class="math inline">\(A\)</span>, <span class="math inline">\(C\)</span>, and <span class="math inline">\(offset\)</span> parameters until you get a solid match.</p>
<p>Alternatively, you can use <code>fitModel()</code> to do the tuning for you. Plug in your estimates (a.k.a. “guesses”) for the parameters in place of the <code>___</code> in the following. Then run the code. You’ll see your estimate of the function compared to the result of having the computer refine your estimate. Chances are, the computer does a better job of stringing the function through the data.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="process-of-modeling.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## rough estimates from graph</span></span>
<span id="cb50-2"><a href="process-of-modeling.html#cb50-2" aria-hidden="true" tabindex="-1"></a>rough_A <span class="ot">&lt;-</span> __estimated_A__</span>
<span id="cb50-3"><a href="process-of-modeling.html#cb50-3" aria-hidden="true" tabindex="-1"></a>rough_C <span class="ot">&lt;-</span> __estimated_C__</span>
<span id="cb50-4"><a href="process-of-modeling.html#cb50-4" aria-hidden="true" tabindex="-1"></a>rough_offset <span class="ot">&lt;-</span> __estimated_offset___</span>
<span id="cb50-5"><a href="process-of-modeling.html#cb50-5" aria-hidden="true" tabindex="-1"></a>guessed_fun <span class="ot">&lt;-</span></span>
<span id="cb50-6"><a href="process-of-modeling.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">makeFun</span>(A<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>(Month <span class="sc">-</span> offset)<span class="sc">/</span><span class="dv">12</span>) <span class="sc">+</span> C <span class="sc">~</span> Month,</span>
<span id="cb50-7"><a href="process-of-modeling.html#cb50-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">A  =</span> rough_A, <span class="at">C =</span> rough_D,</span>
<span id="cb50-8"><a href="process-of-modeling.html#cb50-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">offset =</span> rough_offset)</span>
<span id="cb50-9"><a href="process-of-modeling.html#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="process-of-modeling.html#cb50-10" aria-hidden="true" tabindex="-1"></a>tuned_fun <span class="ot">&lt;-</span></span>
<span id="cb50-11"><a href="process-of-modeling.html#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitModel</span>(Minutes <span class="sc">~</span> A<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>(Month <span class="sc">-</span> offset)<span class="sc">/</span><span class="dv">12</span>) <span class="sc">+</span> C,</span>
<span id="cb50-12"><a href="process-of-modeling.html#cb50-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">data  =</span> SunsetLA,</span>
<span id="cb50-13"><a href="process-of-modeling.html#cb50-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> rough_A,</span>
<span id="cb50-14"><a href="process-of-modeling.html#cb50-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">C =</span> rough_C,</span>
<span id="cb50-15"><a href="process-of-modeling.html#cb50-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">offset =</span> rough_offset) )</span>
<span id="cb50-16"><a href="process-of-modeling.html#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="process-of-modeling.html#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(Minutes <span class="sc">~</span> Month, <span class="at">data =</span> SunsetLA) <span class="sc">%&gt;%</span></span>
<span id="cb50-18"><a href="process-of-modeling.html#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_line</span>(<span class="at">color  =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-19"><a href="process-of-modeling.html#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">tuned_fun</span>(Month) <span class="sc">~</span> Month) <span class="sc">%&gt;%</span></span>
<span id="cb50-20"><a href="process-of-modeling.html#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">guessed_fun</span>(Month) <span class="sc">~</span> Month,  <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</div>
<p>Perhaps you were expecting the tuned sine function to match the data exactly. It does not. One reason for this is that the Earth’s orbit around the Sun is not exactly circular. The sine function is only a <em>model</em> of the phenomenon, good for some purposes and not for others. For a more complete explanation, see <a href="https://en.wikipedia.org/wiki/Sunrise_equation">this article on Wikipedia</a>.</p>
(<em>Thomas Swalm</em> contributed to this exercise.)
</details>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>From the <code>{MMAC}</code> R package<a href="process-of-modeling.html#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="params-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fun-slopes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dtkaplan/CalcZ-notes/edit/shared/Fun-modeling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
